{"remainingRequest":"/Users/stavros/Documents/web/todo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/stavros/Documents/web/todo/src/components/Main.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/stavros/Documents/web/todo/src/components/Main.vue","mtime":1704837092971},{"path":"/Users/stavros/Documents/web/todo/node_modules/cache-loader/dist/cjs.js","mtime":1694974234613},{"path":"/Users/stavros/Documents/web/todo/node_modules/thread-loader/dist/cjs.js","mtime":1694974234613},{"path":"/Users/stavros/Documents/web/todo/node_modules/babel-loader/lib/index.js","mtime":1694974236369},{"path":"/Users/stavros/Documents/web/todo/node_modules/cache-loader/dist/cjs.js","mtime":1694974234613},{"path":"/Users/stavros/Documents/web/todo/node_modules/vue-loader/lib/index.js","mtime":1694974238803}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBWU3dhdGNoZXMgZnJvbSAndnVlLXN3YXRjaGVzJwppbXBvcnQgJ3Z1ZS1zd2F0Y2hlcy9kaXN0L3Z1ZS1zd2F0Y2hlcy5jc3MnCgppbXBvcnQgRGF0ZVBpY2tlciBmcm9tICd2dWUyLWRhdGVwaWNrZXInOwppbXBvcnQgJ3Z1ZTItZGF0ZXBpY2tlci9pbmRleC5jc3MnOwogIAppbXBvcnQgZHJhZ2dhYmxlIGZyb20gJ3Z1ZWRyYWdnYWJsZScKICAKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTWFpbicsCiAgcHJvcHM6IHsKICAgIHRpdGxlOiBTdHJpbmcsCiAgfSwKICBjb21wb25lbnRzOiB7IFZTd2F0Y2hlcyxEYXRlUGlja2VyLGRyYWdnYWJsZSB9LAoKICAgIG1vdW50ZWQoKXsKICAgICAgdGhpcy5sb2FkRGF0YSgpOwogICAgICB0aGlzLmxvYWROb3RpZmljYXRpb25zKCk7CiAgICB9LAoKICBkYXRhKCl7CiAgICByZXR1cm57CiAgICAgIG9wdGlvbjoxLAogICAgICBub3RlczpbXSwgIAogICAgICBub3Rlc05vTGFiZWw6W10sICAgIAogICAgICBlbmFibGVBZGQ6ZmFsc2UsCiAgICAgIGVuYWJsZWRMYWJlbDpmYWxzZSwKICAgICAgZW5hYmxlZE5vdGlmaWNhdGlvbjpmYWxzZSwKICAgICAgY29sb3VyOicjMDAwMDAwJywKICAgICAgbGFiZWxUZXh0OicnLAogICAgICBsYWJlbENvbG91cjonJywgICAgICAgICAgICAKICAgICAgbGFiZWxzOltdLAogICAgICBzZWxlY3RlZExhYmVsOidBbGwgbm90ZXMnLAogICAgICBpc05vdGVPcHRpb25zOmZhbHNlLAogICAgICBub3RlSW5kZXg6JycsCiAgICAgIG5vdGVJZDonJywKICAgICAgc2VsZWN0ZWROb3RlOltdLAogICAgICByZW1pbmRlckRhdGU6IG51bGwsICAgICAgCiAgICAgIHJlbWluZGVyVGltZTogbnVsbCwgCiAgICAgIGRpc3BsYXlEYXRlVGltZTonJywgICAgICAgICAgICAgCiAgICAgIGRhdGVOdWxsOmZhbHNlLAogICAgICB0aW1lTnVsbDpmYWxzZSwKICAgICAgaXNFZGl0OmZhbHNlICwKCiAgICAgIGlzVGFnU2VhcmNoOmZhbHNlLAogICAgICBpc0FjdGl2ZVJlbWluZGVyOmZhbHNlLAogICAgICBpc1VwY29taW5nUmVtaW5kZXI6ZmFsc2UsCiAgICAgIGFjdGl2ZVJlbWluZGVyczowLAogICAgICB1cGNvbWluZ1JlbWluZGVyczowLAogICAgICBub3RpZmljYXRpb25zOjAsCiAgICAgIAoKICAgIH0KICB9LAoKICBtZXRob2RzOnsKICAgIHNldE9wdGlvbihuKXsKICAgICAgICB0aGlzLm9wdGlvbj1uOyAgICAgICAKICAgICAgICB0aGlzLmlzTm90ZU9wdGlvbnM9ZmFsc2U7CiAgICAgICAgLy9zaG93IGFsbCBub3RlcwogICAgICAgIGlmKG49PTEpewogICAgICAgICAgdGhpcy5sb2FkRGF0YSgpOwogICAgICAgICAgdGhpcy5pc0FjdGl2ZVJlbWluZGVyPWZhbHNlOwogICAgICAgICAgdGhpcy5pc1VwY29taW5nUmVtaW5kZXI9ZmFsc2U7CiAgICAgICAgfQogICAgICAgIC8vc2hvdyBub3RlcyB3aXRoIHJlbWluZGVycwogICAgICAgIGlmKG49PTIpewogICAgICAgICAgCiAgICAgICAgICB0aGlzLmxvYWRBY3RpdmVSZW1pbmRlcnMoKTsKICAgICAgICAgIAogICAgICAgICAgdGhpcy5pc0FjdGl2ZVJlbWluZGVyPXRydWU7CiAgICAgICAgICB0aGlzLmlzVGFnU2VhcmNoPWZhbHNlOwogICAgICAgIH0KICAgIH0sCgogICAgYWRkTmV3KCl7CiAgICAgIAogICAgICB0aGlzLmVuYWJsZUFkZD10cnVlOwogICAgICB0aGlzLmlzVGFnU2VhcmNoPWZhbHNlOwogICAgICB0aGlzLmlzTm90ZU9wdGlvbnM9ZmFsc2U7CiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnMubmV3Tm90ZUlucHV0LmZvY3VzKCk7ICAKICAgICAgfSwgMjAwKTsgICAgICAKICAgIH0sCgoKICAgIGNsb3NlQWRkKCl7CiAgICAgIHRoaXMuZW5hYmxlQWRkPWZhbHNlOwogICAgICB0aGlzLmxhYmVscz1bXTsKICAgICAgdGhpcy5yZW1pbmRlckRhdGU9IG51bGw7ICAgICAgICAKICAgICAgdGhpcy5yZW1pbmRlclRpbWU9IG51bGw7IAogICAgICB0aGlzLnRpbWVOdWxsPWZhbHNlOwogICAgICB0aGlzLmRhdGVOdWxsPWZhbHNlOyAgIAogICAgICB0aGlzLmRpc3BsYXlEYXRlVGltZT0nJzsKCiAgICB9LAoKICAgIHRvZ2dsZUxhYmVsKCl7ICAgICAgCiAgICAgIHRoaXMuZW5hYmxlZExhYmVsPSF0aGlzLmVuYWJsZWRMYWJlbDsgICAgICAKICAgICAgaWYodGhpcy5lbmFibGVkTGFiZWwpewogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dF9sYWJlbCcpLmZvY3VzKCk7ICAKICAgICAgICB9LCAxMDApOwogICAgICB9CiAgICAgIGVsc2V7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICBpZih0aGlzLmVuYWJsZUFkZCl7CiAgICAgICAgICAgIHRoaXMuJHJlZnMubmV3Tm90ZUlucHV0LmZvY3VzKCk7ICAKICAgICAgICAgIH0KICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnB1dF9lZGl0JykuZm9jdXMoKTsKICAgICAgICAgIH0KICAgICAgICAKICAgICAgICB9LCAxMDApOwogICAgICB9CiAgICB9LAoKICAgIHRvZ2dsZU5vdGlmaWNhdGlvbigpeyAgICAgIAogICAgICB0aGlzLmVuYWJsZWROb3RpZmljYXRpb249IXRoaXMuZW5hYmxlZE5vdGlmaWNhdGlvbjsKCiAgICAgIC8vY2FuY2VsIGlzIGNsaWNrZWQKICAgICAgaWYoIXRoaXMuZW5hYmxlZE5vdGlmaWNhdGlvbiAmJiB0aGlzLmRpc3BsYXlEYXRlVGltZT09JycpeyAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICB0aGlzLnJlbWluZGVyRGF0ZT0gbnVsbDsgICAgICAgIAogICAgICAgICAgdGhpcy5yZW1pbmRlclRpbWU9IG51bGw7IAogICAgICAgICAgdGhpcy50aW1lTnVsbD1mYWxzZTsKICAgICAgICAgIHRoaXMuZGF0ZU51bGw9ZmFsc2U7ICAgCiAgICAgIH0KICAgICAgCgogICAgfSwKCiAgICBhZGRMYWJlbCgpewogICAgICB0aGlzLmxhYmVsVGV4dD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRfbGFiZWwnKS52YWx1ZS50cmltKCk7CiAgICAgIHRoaXMubGFiZWxDb2xvdXI9dGhpcy5jb2xvdXI7CiAgICAgIC8vIGxldCBuZXdMYWJlbD17bGFiZWxUZXh0OmxhYmVsVGV4dCxjb2xvdXI6bGFiZWxDb2xvdXJ9OwoKICAgICAgLy8gaWYobGFiZWxUZXh0LnRyaW0oKSE9JycpewogICAgICAvLyAgICAgdGhpcy5sYWJlbHMucHVzaChuZXdMYWJlbCk7CiAgICAgIC8vICAgICB0aGlzLnRvZ2dsZUxhYmVsKCk7CiAgICAgIC8vICAgICB9CgogICAgICBpZih0aGlzLmxhYmVsVGV4dCE9JycpewogICAgICAgICAgLy8gdGhpcy5sYWJlbHMuc3BsaWNlKDAsMSxuZXdMYWJlbCk7CiAgICAgICAgICB0aGlzLnRvZ2dsZUxhYmVsKCk7CiAgICAgICAgICB9CgogICAgICAKICAgICAgCiAgICB9LAoKICAgIGFkZFJlbWluZGVyKCl7CiAgICAgIC8vIHRoaXMudG9nZ2xlTm90aWZpY2F0aW9uKCk7ICAgICAgCiAgICAgIGlmKHRoaXMucmVtaW5kZXJEYXRlIT1udWxsICYmIHRoaXMucmVtaW5kZXJUaW1lIT1udWxsKXsKICAgICAgICB0aGlzLmRhdGVOdWxsPWZhbHNlOwogICAgICAgIHRoaXMudGltZU51bGw9ZmFsc2U7CiAgICAgICAgdGhpcy5lbmFibGVkTm90aWZpY2F0aW9uPSF0aGlzLmVuYWJsZWROb3RpZmljYXRpb247CgogICAgICAgIC8vcmVmb3JtYXQgZGF0ZQogICAgICAgIGxldCBmRGF0ZT10aGlzLnJlbWluZGVyRGF0ZS50b0RhdGVTdHJpbmcoKTsKICAgICAgICBmRGF0ZT1mRGF0ZS5zcGxpdCgnICcpOwogICAgICAgIGZEYXRlPWZEYXRlWzJdKycgJytmRGF0ZVsxXSsnICcrZkRhdGVbM107CiAgICAgICAgbGV0IGRpc3BsYXlEYXRlPWZEYXRlOwoKICAgICAgICAvL3JlZm9ybWF0IHRpbWUgICAgICAgIAogICAgICAgIGxldCBmVGltZT10aGlzLnJlbWluZGVyVGltZS50b1N0cmluZygpOwogICAgICAgIGZUaW1lPWZUaW1lLnNwbGl0KCcgJyk7CiAgICAgICAgZlRpbWU9ZlRpbWVbNF07CiAgICAgICAgZlRpbWU9ZlRpbWUuc3BsaXQoJzonKTsKICAgICAgICBmVGltZT1mVGltZVswXSsnOicrZlRpbWVbMV07CiAgICAgICAgbGV0IGRpc3BsYXlUaW1lPWZUaW1lOwogICAgICAgIHRoaXMuZGlzcGxheURhdGVUaW1lPWRpc3BsYXlEYXRlICsgJyAnK2Rpc3BsYXlUaW1lICAgICAgICAKICAgICAgfQoKICAgICAgaWYodGhpcy5yZW1pbmRlckRhdGU9PW51bGwpewogICAgICAgIHRoaXMuZGF0ZU51bGw9dHJ1ZTsKICAgICAgfQoKICAgICAgaWYodGhpcy5yZW1pbmRlclRpbWU9PW51bGwpewogICAgICAgIHRoaXMudGltZU51bGw9dHJ1ZTsKICAgICAgfSAgICAKICAgIH0sCgogICAgc2F2ZU5ldygpewogICAgICBsZXQgbmV3Tm90ZVRleHQ9dGhpcy4kcmVmcy5uZXdOb3RlSW5wdXQudmFsdWU7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMubGFiZWxzKTsKCiAgICAgIGxldCBuZXdOb3RlOwogICAgICBuZXdOb3RlPXt0ZXh0Om5ld05vdGVUZXh0LAogICAgICAgICAgICAgIHJlbWluZGVyRGF0ZTp0aGlzLnJlbWluZGVyRGF0ZSwKICAgICAgICAgICAgICByZW1pbmRlclRpbWU6dGhpcy5yZW1pbmRlclRpbWUsCiAgICAgICAgICAgICAgZGlzcGxheURhdGVUaW1lOnRoaXMuZGlzcGxheURhdGVUaW1lLAogICAgICAgICAgICAgIGxhYmVsVGV4dDp0aGlzLmxhYmVsVGV4dCwKICAgICAgICAgICAgICBsYWJlbENvbG91cjp0aGlzLmxhYmVsQ29sb3VyLAogICAgICAgICAgICAgIGlzQ29tcGxldGVkOmZhbHNlCiAgICAgICAgICAgICAgfTsKICAgIAogICAgICBsZXQgc2VsZiA9IHRoaXM7CiAgICAgIAogICAgICAvL2luZGV4ZWREQgogICAgICBjb25zdCBpbmRleGVkREIgPSB3aW5kb3cuaW5kZXhlZERCIHx8IHdpbmRvdy5tb3pJbmRleGVkREIgfHx3aW5kb3cud2Via2l0SW5kZXhlZERCIHx8d2luZG93Lm1zSW5kZXhlZERCIHx8d2luZG93LnNoaW1JbmRleGVkREI7ICAgICAgCiAgICAgIGNvbnNvbGUubG9nKGluZGV4ZWREQik7ICAgICAgCiAgICAgIGNvbnN0IHJlcXVlc3Q9IGluZGV4ZWREQi5vcGVuKCd0b2RvRGF0YWJhc2UnLDEpOwogICAgICAKICAgICAgLy9vbmVycm9yCiAgICAgIHJlcXVlc3Qub25lcnJvcj1mdW5jdGlvbihldmVudCl7CiAgICAgICAgY29uc29sZS5sb2coZXZlbnQpOwogICAgICB9CgogICAgICAvL29udXBncmFkZW5lZWRlZAogICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZD1mdW5jdGlvbihldmVudCl7CiAgICAgICAgbGV0IGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgICBsZXQgb2JqZWN0U3RvcmU9ZGIuY3JlYXRlT2JqZWN0U3RvcmUoJ25vdGVzJywgeyBrZXlQYXRoOiAiaWQiLCBhdXRvSW5jcmVtZW50OiB0cnVlIH0pOyAgICAgICAgCiAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2xhYmVsSW5kZXgnLCdub3RlLmxhYmVsVGV4dCcse3VuaXF1ZTpmYWxzZX0pOyAgCiAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ25vdGVJbmRleCcsWydub3RlLnRleHQnXSx7dW5pcXVlOmZhbHNlfSk7IAogICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdkYXRlSW5kZXgnLFsnbm90ZS5yZW1pbmRlckRhdGUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgndGltZUluZGV4JyxbJ25vdGUucmVtaW5kZXJUaW1lJ10se3VuaXF1ZTpmYWxzZX0pOyAgICAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coIk9iamVjdCBzdG9yZSBDcmVhdGVkIFN1Y2Nlc3NmdWxseS4uLiIpOwogICAgICB9CgogICAgICAvL29uc3VjY2VzcwogICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCl7ICAgICAgIAogICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgIGNvbnNvbGUubG9nKGRiKTsKICAgICAgIHZhciB0cmFuc2FjdGlvbiA9IGRiLnRyYW5zYWN0aW9uKCJub3RlcyIsICJyZWFkd3JpdGUiKTsKICAgICAgIHZhciBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKCJub3RlcyIpOyAgICAgCiAgICAgICAKICAgICAgIGlmKG5ld05vdGVUZXh0LnRyaW0oKSE9JycpewogICAgICAgb2JqZWN0U3RvcmUuYWRkKHsgbm90ZTogbmV3Tm90ZX0pOwogICAgICAgIGRiLmNsb3NlKCk7CiAgICAgICAgc2VsZi5lbmFibGVBZGQ9ZmFsc2U7CiAgICAgICAgc2VsZi5sYWJlbFRleHQ9JycsCiAgICAgICAgc2VsZi5sYWJlbENvbG91cj0nJwogICAgICAgIAogICAgICAgIHNlbGYucmVtaW5kZXJEYXRlPW51bGw7CiAgICAgICAgc2VsZi5yZW1pbmRlclRpbWU9bnVsbDsKICAgICAgICBzZWxmLmRpc3BsYXlEYXRlVGltZT0nJzsKCiAgICAgIH0KICAgICAgIHRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7ICAgCiAgICAgICBzZWxmLmxhYmVscz1bXTsKICAgICAgIHNlbGYuc2VsZWN0ZWRMYWJlbD0nQWxsIG5vdGVzJzsgICAgICAgICAgICAgCiAgICAgICBzZWxmLmxvYWREYXRhKCk7CiAgICAgICBzZWxmLmxvYWROb3RpZmljYXRpb25zKCk7CiAgICAgICAgfTsKICAgICB9CgogICAgfSwKCiAgICB0b2dnbGVOb3RlT3B0aW9ucyhuLGlkKXsgICAgICAKICAgICAgCiAgICAgIHRoaXMuc2VsZWN0ZWROb3RlPVtdOwogICAgICAvL2dldCBzZWxlY3RlZCBub3RlJ3MgaWQKICAgICAgdGhpcy5ub3RlSWQ9aWQ7CgoKICAgICAgLy9zZXQgZ2V0IHNlbGVjdGVkIG5vdGUKICAgICAgZm9yKGxldCBuIG9mIHRoaXMubm90ZXMpewoKICAgICAgICBjb25zb2xlLmxvZyhuLmlkKTsKICAgICAgICBpZihuLmlkPT1pZCl7CiAgICAgICAgICB0aGlzLnNlbGVjdGVkTm90ZS5wdXNoKG4pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgY29uc29sZS5sb2codGhpcy5ub3Rlcyk7CiAgICAgIGNvbnNvbGUubG9nKHRoaXMuc2VsZWN0ZWROb3RlKTsKICAgICAgdGhpcy5ub3RlSW5kZXg9bjsgICAgICAKICAgICAgdGhpcy5pc05vdGVPcHRpb25zPSF0aGlzLmlzTm90ZU9wdGlvbnM7CiAgICB9LAoKICAgIGRlbGV0ZU5vdGUoaWQsY29tcGxldGUpeyAgICAgIAogICAgLy8gIHRoaXMubm90ZXMuc3BsaWNlKG4sMSk7CiAgICAvLyAgdGhpcy5pc05vdGVPcHRpb25zPSF0aGlzLmlzTm90ZU9wdGlvbnM7CgoKICAgIC8vZGVsZXRlIG5vdGUgZnJvbSBkYgoKICAgIGxldCBzZWxmPXRoaXM7CiAgICAgICAgY29uc3QgaW5kZXhlZERCID0gd2luZG93LmluZGV4ZWREQiB8fCB3aW5kb3cubW96SW5kZXhlZERCIHx8d2luZG93LndlYmtpdEluZGV4ZWREQiB8fHdpbmRvdy5tc0luZGV4ZWREQiB8fHdpbmRvdy5zaGltSW5kZXhlZERCOwogICAgICAgIAogICAgICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbigidG9kb0RhdGFiYXNlIiwgMSk7CiAgICAgIAogICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJyZXF1ZXN0IGVycm9yIGRlbGV0ZU5vdGUiKTsKICAgICAgICB9CgogICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgdmFyIG9iamVjdFN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoIm5vdGVzIix7a2V5UGF0aCA6ImlkIiwgIGF1dG9JbmNyZW1lbnQ6dHJ1ZX0pOwogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnbGFiZWxJbmRleCcsJ25vdGUubGFiZWxUZXh0Jyx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ25vdGVJbmRleCcsWydub3RlLnRleHQnXSx7dW5pcXVlOmZhbHNlfSk7CiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdkYXRlSW5kZXgnLFsnbm90ZS5yZW1pbmRlckRhdGUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ3RpbWVJbmRleCcsWydub3RlLnJlbWluZGVyVGltZSddLHt1bmlxdWU6ZmFsc2V9KTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJPYmplY3Qgc3RvcmUgQ3JlYXRlZCBTdWNjZXNzZnVsbHkuLi4iKTsKICAgICAgICB9OwoKCiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpeyAgICAgICAKICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbignbm90ZXMnLCdyZWFkd3JpdGUnKTsKICAgICAgICAgIGNvbnN0IG9iamVjdFN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoIm5vdGVzIik7CgogICAgICAgICAgY29uc3QgZGVsZXRlTm90ZSA9IG9iamVjdFN0b3JlLmRlbGV0ZShpZCk7CiAgICAgICAgICBkZWxldGVOb3RlLm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICBjb25zb2xlLmxvZygnbm90ZSBpZDogJytpZCsgJyBkZWxldGVkJyk7CiAgICAgICAgICAKICAgICAgICAgfSAgCiAgICAgICAgICAgIAogICAgICAgICAgdHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsgICAgIAoKICAgICAgICAgICAgaWYoc2VsZi5vcHRpb249PTEpewogICAgICAgICAgICAgIGlmKHNlbGYuaXNUYWdTZWFyY2gpeyAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgc2VsZi5zZWxlY3RlZExhYmVsPSdBbGwgbm90ZXMnOyAgICAgICAgICAKICAgICAgICAgICAgICAgIHNlbGYubG9hZFRhZ3MoKTsgIAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgc2VsZi5sb2FkRGF0YSgpOyAgCgogICAgICAgICAgICAgICAgc2VsZi5sYWJlbHM9W107CiAgICAgICAgICAgICAgICAgIHNlbGYucmVtaW5kZXI9W107CiAgICAgICAgICAgICAgICAgIHNlbGYucmVtaW5kZXJEYXRlPW51bGw7CiAgICAgICAgICAgICAgICAgIHNlbGYucmVtaW5kZXJUaW1lPW51bGw7CiAgICAgICAgICAgICAgICAgIHNlbGYuZGlzcGxheURhdGVUaW1lPScnOwoKICAgICAgICAgICAgICB9ICAgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgZWxzZSBpZihzZWxmLm9wdGlvbj09Mil7CgogICAgICAgICAgICAgIGlmKHNlbGYuaXNBY3RpdmVSZW1pbmRlcil7CiAgICAgICAgICAgICAgICBzZWxmLmxvYWRBY3RpdmVSZW1pbmRlcnMoKTsKICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgc2VsZi5sb2FkVXBjb21pbmdSZW1pbmRlcnMoKTsKICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfQoKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBpZihjb21wbGV0ZT09dHJ1ZSl7CiAgICAgICAgICAgICAgdGhpcy5pc05vdGVPcHRpb25zPWZhbHNlOwogICAgICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgc2VsZi5pc05vdGVPcHRpb25zPSFzZWxmLmlzTm90ZU9wdGlvbnM7ICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgICBkYi5jbG9zZSgpOwogICAgICAgICAgICBzZWxmLmxvYWROb3RpZmljYXRpb25zKCk7CiAgICAgICAgICB9OwogICAgICAgICAgCiAgICAgICAgfQoKICAgIH0sCgogICAgdG9nZ2xlRWRpdCgpeyAgICAgICAgICAgICAgIAogICAgICB0aGlzLmlzRWRpdD0hdGhpcy5pc0VkaXQ7CiAgICAgIHRoaXMuaXNOb3RlT3B0aW9ucz0hdGhpcy5pc05vdGVPcHRpb25zOwogICAgICAgCiAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmKHRoaXMuaXNFZGl0KXsKCiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0X2VkaXQnKS5mb2N1cygpOwogICAgICAgIAogICAgICAgIHRoaXMubGFiZWxUZXh0PSB0aGlzLm5vdGVzW3RoaXMubm90ZUluZGV4XS5sYWJlbFRleHQ7CiAgICAgICAgCiAgICAgICAgdGhpcy5sYWJlbENvbG91cj0gdGhpcy5ub3Rlc1t0aGlzLm5vdGVJbmRleF0ubGFiZWxDb2xvdXI7CiAgICAgIAogICAgICAgIAogICAgICAgIHRoaXMucmVtaW5kZXJEYXRlPW51bGw7CiAgICAgICAgdGhpcy5yZW1pbmRlclRpbWU9bnVsbDsKCiAgICAgICAgdGhpcy5yZW1pbmRlckRhdGU9dGhpcy5ub3Rlc1t0aGlzLm5vdGVJbmRleF0ucmVtaW5kZXJEYXRlOwogICAgICAgIHRoaXMucmVtaW5kZXJUaW1lPXRoaXMubm90ZXNbdGhpcy5ub3RlSW5kZXhdLnJlbWluZGVyVGltZTsKICAgICAgICB0aGlzLmRpc3BsYXlEYXRlVGltZT10aGlzLm5vdGVzW3RoaXMubm90ZUluZGV4XS5kaXNwbGF5RGF0ZVRpbWU7CiAgICAgICAgCiAgICAgIH0KICAgICAgfSwgMTAwKTsKICAgICAgCgogICAgfSwKCiAgICBzYXZlRWRpdCgpewogICAgICBpZihkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5wdXRfZWRpdCcpLnZhbHVlLnRyaW0oKSE9JycpewoKICAgICAgICAvL3VwZGF0ZWQgZmllbGQgdmFsdWVzCiAgICAgICAgICBsZXQgdGV4dD0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2lucHV0X2VkaXQnKS52YWx1ZS50cmltKCk7CiAgICAgICAgICBsZXQgbGFiZWxUZXh0PXRoaXMubGFiZWxUZXh0OwogICAgICAgICAgbGV0IGxhYmVsQ29sb3VyPXRoaXMubGFiZWxDb2xvdXI7CiAgICAgICAgICBsZXQgcmVtaW5kZXJEYXRlPXRoaXMucmVtaW5kZXJEYXRlOwogICAgICAgICAgbGV0IHJlbWluZGVyVGltZT10aGlzLnJlbWluZGVyVGltZTsKICAgICAgICAgIGxldCBkaXNwbGF5RGF0ZVRpbWUgPSB0aGlzLmRpc3BsYXlEYXRlVGltZTsKICAgICAgICAgIAoKICAgICAgICAvL3NhdmUgY2hhbmdlcyB0byBpbmRleGVkREIKICAgICAgICBsZXQgc2VsZj10aGlzOwogICAgICAgIGNvbnN0IGluZGV4ZWREQiA9IHdpbmRvdy5pbmRleGVkREIgfHwgd2luZG93Lm1vekluZGV4ZWREQiB8fHdpbmRvdy53ZWJraXRJbmRleGVkREIgfHx3aW5kb3cubXNJbmRleGVkREIgfHx3aW5kb3cuc2hpbUluZGV4ZWREQjsKICAgICAgICAKICAgICAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oInRvZG9EYXRhYmFzZSIsIDEpOwogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpewogICAgICAgICAgICBjb25zb2xlLmxvZygicmVxdWVzdCBlcnJvciAtIHNhdmVFZGl0Iik7CiAgICAgICAgfQoKICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgIHZhciBvYmplY3RTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKCJub3RlcyIse2tleVBhdGggOiJpZCIsICBhdXRvSW5jcmVtZW50OnRydWV9KTsKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2xhYmVsSW5kZXgnLFsnbm90ZS5sYWJlbFRleHQnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ25vdGVJbmRleCcsWydub3RlLnRleHQnXSx7dW5pcXVlOmZhbHNlfSk7IAogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnZGF0ZUluZGV4JyxbJ25vdGUucmVtaW5kZXJEYXRlJ10se3VuaXF1ZTpmYWxzZX0pOyAgCiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCd0aW1lSW5kZXgnLFsnbm90ZS5yZW1pbmRlclRpbWUnXSx7dW5pcXVlOmZhbHNlfSk7ICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zb2xlLmxvZygiT2JqZWN0IHN0b3JlIENyZWF0ZWQgU3VjY2Vzc2Z1bGx5Li4uIik7CiAgICAgICAgfTsKCiAgICAgICAgCgogICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KXsgICAgICAgCiAgICAgICAgICB2YXIgZGIgPSBldmVudC50YXJnZXQucmVzdWx0OwogICAgICAgICAgbGV0IHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oIm5vdGVzIiwicmVhZHdyaXRlIik7CiAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKCJub3RlcyIpOwoKICAgICAgICAgIC8vZ2V0IHJlY29yZCB0byBtb2RpZnkKICAgICAgICAgIGNvbnN0IHJlY29yZFJlcXVlc3QgPSBvYmplY3RTdG9yZS5nZXQoc2VsZi5ub3RlSWQpOwoKICAgICAgICAgIAoKICAgICAgICAgIHJlY29yZFJlcXVlc3Qub25zdWNjZXNzPWZ1bmN0aW9uKCl7CgogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IHJlY29yZCA9IHJlY29yZFJlcXVlc3QucmVzdWx0OwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZWNvcmQpOyAgICAKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgcmVjb3JkLm5vdGUudGV4dCA9IHRleHQ7CiAgICAgICAgICAgIHJlY29yZC5ub3RlLnJlbWluZGVyRGF0ZT1yZW1pbmRlckRhdGU7CiAgICAgICAgICAgIHJlY29yZC5ub3RlLnJlbWluZGVyVGltZT1yZW1pbmRlclRpbWU7CiAgICAgICAgICAgIHJlY29yZC5ub3RlLmRpc3BsYXlEYXRlVGltZT1kaXNwbGF5RGF0ZVRpbWU7ICAgICAgICAgICAgCiAgICAgICAgICAgIHJlY29yZC5ub3RlLmxhYmVsVGV4dD1sYWJlbFRleHQ7CiAgICAgICAgICAgIHJlY29yZC5ub3RlLmxhYmVsQ29sb3VyPWxhYmVsQ29sb3VyOwogICAgICAgICAgICByZWNvcmQubm90ZS5pc0NvbXBsZXRlZD1mYWxzZTsKCgogICAgICAgICAgICAvL3NhdmUgbmV3IHZhbHVlcyB0byBpbmRleGVkREIKICAgICAgICAgICAgY29uc3QgdXBkYXRlUmVxdWVzdD1vYmplY3RTdG9yZS5wdXQocmVjb3JkKTsKCiAgICAgICAgICAgIHVwZGF0ZVJlcXVlc3Qub25zdWNjZXNzPWZ1bmN0aW9uKCl7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JlY29yZCB1cGRhdGVkJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgCiAgICAgICAgICB9CiAgICAgICAgICB0cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZWxmLmxhYmVsVGV4dD0nJzsKICAgICAgICAgICAgc2VsZi5sYWJlbENvbG91cj0nJzsgICAgICAgICAgICAKICAgICAgICAgICAgc2VsZi5yZW1pbmRlckRhdGU9bnVsbDsKICAgICAgICAgICAgc2VsZi5yZW1pbmRlclRpbWU9bnVsbDsKICAgICAgICAgICAgc2VsZi5kaXNwbGF5RGF0ZVRpbWU9Jyc7CgogICAgICAgICAgICAvL3Nob3cgYWxsIG5vdGVzIChmaWx0ZXJlZCBieSB0YWcgb3Igbm90KQogICAgICAgICAgICBpZihzZWxmLm9wdGlvbj09MSl7CiAgICAgICAgICAgICAgaWYoc2VsZi5pc1RhZ1NlYXJjaCl7ICAgIAogICAgICAgICAgICAgICAgaWYoc2VsZi5zZWxlY3RlZExhYmVsIT0nQWxsIG5vdGVzJyl7CiAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRMYWJlbD1sYWJlbFRleHQ7ICAgICAgICAgCiAgICAgICAgICAgICAgICB9ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIHNlbGYubG9hZFRhZ3MoKTsgIAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgc2VsZi5sb2FkRGF0YSgpOyAgCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vc2hvdyBub3RlcyB3aXRoIHJlbWluZGVycwogICAgICAgICAgICBlbHNlIGlmIChzZWxmLm9wdGlvbj09Mil7CiAgICAgICAgICAgICAgIGlmKHNlbGYuaXNBY3RpdmVSZW1pbmRlcil7CiAgICAgICAgICAgICAgICBzZWxmLmxvYWRBY3RpdmVSZW1pbmRlcnMoKTsKICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgc2VsZi5sb2FkVXBjb21pbmdSZW1pbmRlcnMoKTsKICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgICBzZWxmLmxvYWROb3RpZmljYXRpb25zKCk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGRiLmNsb3NlKCk7CiAgICAgICAgICB9OwoKCiAgICAgICAgICB9OwoKICAgICAgfQogICAgICAKICAgICAgCiAgICAgIHRoaXMuaXNFZGl0PSF0aGlzLmlzRWRpdDsKICAgICAgCiAgICAgCiAgICB9LAoKICAgIGRlbGV0ZUxhYmVsKCl7ICAgICAgICAgICAgCiAgICAgIHRoaXMubGFiZWxUZXh0PScnOwogICAgICB0aGlzLmxhYmVsQ29sb3VyPScnOwogICAgfSwKCiAgICBkZWxldGVSZW1pbmRlcigpeyAgICAKICAgICAgICAgICAgCiAgICAgIHRoaXMucmVtaW5kZXJEYXRlPW51bGw7CiAgICAgIHRoaXMucmVtaW5kZXJUaW1lPW51bGw7CiAgICAgIHRoaXMuZGlzcGxheURhdGVUaW1lPScnOwogICAgICBpZih0aGlzLm5vdGVzIT0nJyl7CiAgICAgICAgdGhpcy5ub3Rlc1t0aGlzLm5vdGVJbmRleF0ucmVtaW5kZXIucmVtaW5kZXJEYXRlPW51bGw7CiAgICAgICAgdGhpcy5ub3Rlc1t0aGlzLm5vdGVJbmRleF0ucmVtaW5kZXIucmVtaW5kZXJUaW1lPW51bGw7CiAgICAgIH0KICAgICAgCiAgICB9LAoKICAgICB0b2dnbGVUaW1lUGFuZWwoKSB7CiAgICAgIHRoaXMuc2hvd1RpbWVQYW5lbCA9ICF0aGlzLnNob3dUaW1lUGFuZWw7CiAgICB9LAoKICAgIGxvYWREYXRhKCl7CiAgICAgIAogICAgICAgIAogICAgICAgIGxldCBzZWxmPXRoaXM7CiAgICAgICAgY29uc3QgaW5kZXhlZERCID0gd2luZG93LmluZGV4ZWREQiB8fCB3aW5kb3cubW96SW5kZXhlZERCIHx8d2luZG93LndlYmtpdEluZGV4ZWREQiB8fHdpbmRvdy5tc0luZGV4ZWREQiB8fHdpbmRvdy5zaGltSW5kZXhlZERCOwogICAgICAgIAogICAgICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbigidG9kb0RhdGFiYXNlIiwgMSk7CiAgICAgICAgCiAgICAgICAgbGV0IGZvdW5kTm90ZXM9W107CiAgICAgICAgCiAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgY29uc29sZS5sb2coImRhdGFiYXNlIHRlc3QgY3JlYXRpb24gZXJyb3IiKTsKICAgICAgICB9CgogICAgICAgIHJlcXVlc3Qub251cGdyYWRlbmVlZGVkID0gZnVuY3Rpb24oZXZlbnQpIHsKICAgICAgICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgICAgdmFyIG9iamVjdFN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoIm5vdGVzIix7a2V5UGF0aCA6ImlkIiwgIGF1dG9JbmNyZW1lbnQ6dHJ1ZX0pOwogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnbGFiZWxJbmRleCcsJ25vdGUubGFiZWxUZXh0Jyx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ25vdGVJbmRleCcsWydub3RlLnRleHQnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2RhdGVJbmRleCcsWydub3RlLnJlbWluZGVyRGF0ZSddLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ3RpbWVJbmRleCcsWydub3RlLnJlbWluZGVyVGltZSddLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgICAKICAgICAgICAgICAgY29uc29sZS5sb2coIk9iamVjdCBzdG9yZSBDcmVhdGVkIFN1Y2Nlc3NmdWxseS4uLiIpOwogICAgICAgIH07CgoKICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCl7ICAgICAgIAogICAgICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgIGxldCB0cmFuc2FjdGlvbiA9IGRiLnRyYW5zYWN0aW9uKCJub3RlcyIpOwogICAgICAgICAgY29uc3Qgb2JqZWN0U3RvcmUgPSB0cmFuc2FjdGlvbi5vYmplY3RTdG9yZSgibm90ZXMiKTsKCiAgICAgICAgICAgIC8vIHJlYWQgdGhyb3VnaCB0YWJsZQogICAgICAgICAgICBvYmplY3RTdG9yZS5vcGVuQ3Vyc29yKCkub25zdWNjZXNzID0gZXZlbnQgPT4geyAKICAgICAgICAgICAgICB2YXIgY3Vyc29yID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsgCiAgICAgICAgICAgICAgaWYgKGN1cnNvcikgeyAKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdpcyBjdXJzb3InKQogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgbGV0IHJlY29yZDsKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgIHJlY29yZD17aWQ6Y3Vyc29yLnZhbHVlLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRleHQ6Y3Vyc29yLnZhbHVlLm5vdGUudGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFRleHQ6Y3Vyc29yLnZhbHVlLm5vdGUubGFiZWxUZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsQ29sb3VyOmN1cnNvci52YWx1ZS5ub3RlLmxhYmVsQ29sb3VyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWluZGVyRGF0ZTpjdXJzb3IudmFsdWUubm90ZS5yZW1pbmRlckRhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtaW5kZXJUaW1lOmN1cnNvci52YWx1ZS5ub3RlLnJlbWluZGVyVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5RGF0ZVRpbWU6Y3Vyc29yLnZhbHVlLm5vdGUuZGlzcGxheURhdGVUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzQ29tcGxldGVkOmN1cnNvci52YWx1ZS5ub3RlLmlzQ29tcGxldGVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlY29yZCk7CiAgICAgICAgICAgICAgICAgIGZvdW5kTm90ZXMucHVzaChyZWNvcmQpOyAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGN1cnNvci52YWx1ZSk7CgogICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiaWQ6ICIrIGN1cnNvci52YWx1ZS5pZCk7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJ0ZXh0OiAiKyBjdXJzb3IudmFsdWUubm90ZS50ZXh0KTsKICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgIGN1cnNvci5jb250aW51ZSgpOyAKICAgICAgICAgICAgICB9IGVsc2UgeyAKICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VuZCBvZiB0YWJsZScpOwogICAgICAgICAgICAgIH0gCiAgICAgICAgICAgIH07CgogICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgdHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgY29uc29sZS5sb2coZm91bmROb3Rlcyk7CiAgICAgICAgICAgIHNlbGYubm90ZXM9W107CiAgICAgICAgICAgIGZvcihsZXQgbiBvZiBmb3VuZE5vdGVzKXsKICAgICAgICAgICAgICBzZWxmLm5vdGVzLnB1c2gobik7ICAgICAgICAgIAogICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5ub3RlcykKICAgICAgICAgICAgIAogICAgICAgICAgICBkYi5jbG9zZSgpOwogICAgICAgICAgfTsKCiAgICAgICAgICAKICAgICAgICB9CgogICAgCgogICAgfSwKCiAgICBkZWxldGVEQigpewoKICAgICAgY29uc3QgaW5kZXhlZERCID0gd2luZG93LmluZGV4ZWREQiB8fCB3aW5kb3cubW96SW5kZXhlZERCIHx8d2luZG93LndlYmtpdEluZGV4ZWREQiB8fHdpbmRvdy5tc0luZGV4ZWREQiB8fHdpbmRvdy5zaGltSW5kZXhlZERCOwogICAgICAKICAgICAgaW5kZXhlZERCLmRlbGV0ZURhdGFiYXNlKCJ0b2RvRGF0YWJhc2UiKTsgICAgICAKICAgICAgCiAgICB9LAoKICAgIHJlc29ydCgpewoKICAgICAgbGV0IHNlbGYgPXRoaXM7CiAgICAgIAogICAgICB0aGlzLmRlbGV0ZURCKCk7IAogIAogICAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oInRvZG9EYXRhYmFzZSIsMSk7CgogICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZD1mdW5jdGlvbihldmVudCl7CiAgICAgICAgbGV0IGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgICBsZXQgb2JqZWN0U3RvcmU9ZGIuY3JlYXRlT2JqZWN0U3RvcmUoJ25vdGVzJywgeyBrZXlQYXRoOiAiaWQiLCBhdXRvSW5jcmVtZW50OiB0cnVlIH0pOyAgICAgICAgCiAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2xhYmVsSW5kZXgnLFsnbm90ZS5sYWJlbFRleHQnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnbm90ZUluZGV4JyxbJ25vdGUudGV4dCddLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdkYXRlSW5kZXgnLFsnbm90ZS5yZW1pbmRlckRhdGUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgndGltZUluZGV4JyxbJ25vdGUucmVtaW5kZXJUaW1lJ10se3VuaXF1ZTpmYWxzZX0pOyAgCiAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coIk9iamVjdCBzdG9yZSBDcmVhdGVkIFN1Y2Nlc3NmdWxseS4uLiIpOwogICAgICB9CgogICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpeyAgICAgICAKICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbigibm90ZXMiLCJyZWFkd3JpdGUiKTsKICAgICAgIGNvbnN0IG9iamVjdFN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoIm5vdGVzIik7CiAgICAgICAgY29uc29sZS5sb2cob2JqZWN0U3RvcmUpOwoKICAgICAgCgogICAgICBzZWxmLm5vdGVzLmZvckVhY2goZnVuY3Rpb24gKG4pIHsgICAgIAogICAgICBsZXQgbmV3Tm90ZT17IAogICAgICAgICAgICAgICAgICAgdGV4dDpuLnRleHQsCiAgICAgICAgICAgICAgICAgICBsYWJlbFRleHQ6bi5sYWJlbFRleHQsCiAgICAgICAgICAgICAgICAgICBsYWJlbENvbG91cjpuLmxhYmVsQ29sb3VyLAogICAgICAgICAgICAgICAgICAgcmVtaW5kZXJEYXRlOm4ucmVtaW5kZXJEYXRlLAogICAgICAgICAgICAgICAgICAgcmVtaW5kZXJUaW1lOm4ucmVtaW5kZXJUaW1lLAogICAgICAgICAgICAgICAgICAgZGlzcGxheURhdGVUaW1lOm4uZGlzcGxheURhdGVUaW1lLAogICAgICAgICAgICAgICAgICAgaXNDb21wbGV0ZWQ6bi5pc0NvbXBsZXRlZAogICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICB9CiAgICAgIG9iamVjdFN0b3JlLmFkZCh7IG5vdGU6IG5ld05vdGV9KTsKICAgICAgCiAgICAgIGNvbnNvbGUubG9nKG4udGV4dCsnLScrIG4uaWQpICAgICAgICAgIAogICAgICAgICAgLy8gb2JqZWN0U3RvcmUucHV0KHtpZDogbiwgbmFtZTogImRlZXZhbmEiLGJyYW5jaDogIkNTRSJ9KTsKICAgICAgfSkKIAogICAgICB0cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKCkgeyAgICAgICAgCiAgICAgICAgY29uc29sZS5sb2coJ3Jlc29ydGluZyB1cGRhdGVkJyk7CiAgICAgICAgCiAgICAgICAgc2VsZi5sb2FkRGF0YSgpOwogICAgICAgIGRiLmNsb3NlKCk7CgogICAgICB9OwoKICAgIAogICAgICAgICAgCiAgICB9CgogICAgfSwKCiAgICB0b2dnbGVUYWdTZWFyY2goKXsKICAgICAgdGhpcy5pc1RhZ1NlYXJjaD0hdGhpcy5pc1RhZ1NlYXJjaDsKICAgICAgdGhpcy5lbmFibGVBZGQ9ZmFsc2U7CiAgICAgIHRoaXMuaXNOb3RlT3B0aW9ucz1mYWxzZTsKICAgICAgaWYodGhpcy5pc1RhZ1NlYXJjaCl7CiAgICAgICAgdGhpcy5sb2FkVGFncygpOwogICAgICAgIAogICAgICB9CiAgICAgIGVsc2V7CiAgICAgICAgdGhpcy51bmxvYWRUYWdzKCk7CiAgICAgIH0KICAgICAgCiAgICB9LCAKCiAgICBsb2FkTGFiZWxzKCl7CiAgICAgIC8vcG9wdWxhdGUgbGFiZWxzW10gd2l0aCBsYWJlbFRleHQgdmFsdWVzCgogICAgICB0aGlzLmxhYmVscz1bXTsKICAgICAgdGhpcy5sYWJlbHMucHVzaCgnQWxsIG5vdGVzJyk7CgoKCiAgICAgIGxldCBzZWxmPXRoaXM7CiAgICAgIGNvbnN0IGluZGV4ZWREQiA9IHdpbmRvdy5pbmRleGVkREIgfHwgd2luZG93Lm1vekluZGV4ZWREQiB8fHdpbmRvdy53ZWJraXRJbmRleGVkREIgfHx3aW5kb3cubXNJbmRleGVkREIgfHx3aW5kb3cuc2hpbUluZGV4ZWREQjsKICAgICAgICAKICAgICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKCJ0b2RvRGF0YWJhc2UiLCAxKTsKICAgICAgICAgICAgICAKICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgY29uc29sZS5sb2coImRhdGFiYXNlIHRlc3QgY3JlYXRpb24gZXJyb3IiKTsKICAgICAgfQoKICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICB2YXIgZGIgPSBldmVudC50YXJnZXQucmVzdWx0OwogICAgICAgICAgICB2YXIgb2JqZWN0U3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZSgibm90ZXMiLHtrZXlQYXRoIDoiaWQiLCAgYXV0b0luY3JlbWVudDp0cnVlfSk7CiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdsYWJlbEluZGV4Jywnbm90ZS5sYWJlbFRleHQnLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnbm90ZUluZGV4JyxbJ25vdGUudGV4dCddLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnZGF0ZUluZGV4JyxbJ25vdGUucmVtaW5kZXJEYXRlJ10se3VuaXF1ZTpmYWxzZX0pOyAgCiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCd0aW1lSW5kZXgnLFsnbm90ZS5yZW1pbmRlclRpbWUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgICAgY29uc29sZS5sb2coIk9iamVjdCBzdG9yZSBDcmVhdGVkIFN1Y2Nlc3NmdWxseS4uLiIpOwogICAgICAgIH07CgoKICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCl7ICAgCiAgICAgICAgICAKICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbigibm90ZXMiKTsgICAgICAgICAgCiAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKCJub3RlcyIpOwogICAgICAgICAgbGV0IGxhYmVsSW5kZXggPSBvYmplY3RTdG9yZS5pbmRleCgibGFiZWxJbmRleCIpOwogICAgICAgICAgCgogICAgICAgICAgCgogICAgICAgICAgbGV0IHJlcXVlc3QgID0gbGFiZWxJbmRleC5nZXRBbGwoKTsKICAgICAgICAgIAogICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdWNjZXNzJyk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcXVlc3QucmVzdWx0KTsKICAgICAgICAgICAgbGV0IHJlc3VsdHM9IHJlcXVlc3QucmVzdWx0OwogICAgICAgICAgICAKICAgICAgICAgICAgZm9yKGxldCByIG9mIHJlc3VsdHMpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgIGxldCBleGlzdHM9ZmFsc2U7CiAgICAgICAgICAgICAgICBzZWxmLmxhYmVscy5mb3JFYWNoKGwgPT4gewogICAgICAgICAgICAgICAgIGlmKHIubm90ZS5sYWJlbFRleHQ9PWwpewogICAgICAgICAgICAgICAgICBleGlzdHM9dHJ1ZTsKICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYoZXhpc3RzPT1mYWxzZSl7CiAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICBzZWxmLmxhYmVscy5wdXNoKHIubm90ZS5sYWJlbFRleHQpOwogICAgICAgICAgICAgICAgfSAgIAoKICAgICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgfTsKCiAgICAgICAgICB0cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZGIuY2xvc2UoKTsKICAgICAgICAgIH07CiAgICAgICAgfSAgICAgICAgICAgCiAgICB9LAoKICAgIAogICAgbG9hZFRhZ3MoKXsKICAgICAgICAKICAgICAgICB0aGlzLmVuYWJsZUFkZD1mYWxzZTsKICAgICAgICB0aGlzLm5vdGVzPVtdOwogICAgICAgIHRoaXMubG9hZExhYmVscygpOwoKICAgICAgCiAgICAgICAgCiAgICAgICAgbGV0IHNlbGY9dGhpczsKICAgICAgICBjb25zdCBpbmRleGVkREIgPSB3aW5kb3cuaW5kZXhlZERCIHx8IHdpbmRvdy5tb3pJbmRleGVkREIgfHx3aW5kb3cud2Via2l0SW5kZXhlZERCIHx8d2luZG93Lm1zSW5kZXhlZERCIHx8d2luZG93LnNoaW1JbmRleGVkREI7CiAgICAgICAgCiAgICAgICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKCJ0b2RvRGF0YWJhc2UiLCAxKTsKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpewogICAgICAgICAgICBjb25zb2xlLmxvZygiZGF0YWJhc2UgdGVzdCBjcmVhdGlvbiBlcnJvciIpOwogICAgICAgIH0KCiAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICB2YXIgZGIgPSBldmVudC50YXJnZXQucmVzdWx0OwogICAgICAgICAgICB2YXIgb2JqZWN0U3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZSgibm90ZXMiLHtrZXlQYXRoIDoiaWQiLCAgYXV0b0luY3JlbWVudDp0cnVlfSk7CiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdsYWJlbEluZGV4Jywnbm90ZS5sYWJlbFRleHQnLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnbm90ZUluZGV4JyxbJ25vdGUudGV4dCddLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnZGF0ZUluZGV4JyxbJ25vdGUucmVtaW5kZXJEYXRlJ10se3VuaXF1ZTpmYWxzZX0pOyAgCiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCd0aW1lSW5kZXgnLFsnbm90ZS5yZW1pbmRlclRpbWUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgICAgY29uc29sZS5sb2coIk9iamVjdCBzdG9yZSBDcmVhdGVkIFN1Y2Nlc3NmdWxseS4uLiIpOwogICAgICAgIH07CgoKICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCl7ICAgCiAgICAgICAgICAKICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbigibm90ZXMiKTsgICAgICAgICAgCiAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKCJub3RlcyIpOwogICAgICAgICAgbGV0IGxhYmVsSW5kZXggPSBvYmplY3RTdG9yZS5pbmRleCgibGFiZWxJbmRleCIpOwogICAgICAgICAgCgogICAgICAgICAgbGV0IHJlcXVlc3Q9Jyc7CiAgICAgICAgICBpZihzZWxmLnNlbGVjdGVkTGFiZWw9PSdBbGwgbm90ZXMnKXsKICAgICAgICAgICAgcmVxdWVzdCA9IGxhYmVsSW5kZXguZ2V0QWxsKCk7CgogICAgICAgICAgfQogICAgICAgICAgZWxzZXsKICAgICAgICAgICAgcmVxdWVzdCA9IGxhYmVsSW5kZXguZ2V0QWxsKHNlbGYuc2VsZWN0ZWRMYWJlbCk7CiAgICAgICAgICAgCiAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdWNjZXNzJyk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcXVlc3QucmVzdWx0KTsKICAgICAgICAgICAgbGV0IHJlc3VsdHM9IHJlcXVlc3QucmVzdWx0OwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHRzKTsKICAgICAgICAgICAgZm9yKGxldCByIG9mIHJlc3VsdHMpewogICAgICAgICAgICAgIGxldCByZXN1bHROb3RlPXtpZDpyLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OnIubm90ZS50ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFRleHQ6ci5ub3RlLmxhYmVsVGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxDb2xvdXI6ci5ub3RlLmxhYmVsQ29sb3VyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1pbmRlckRhdGU6ci5ub3RlLnJlbWluZGVyRGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtaW5kZXJUaW1lOnIubm90ZS5yZW1pbmRlclRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlEYXRlVGltZTpyLm5vdGUuZGlzcGxheURhdGVUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0NvbXBsZXRlZDpyLm5vdGUuaXNDb21wbGV0ZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAKICAgICAgICAgICAgICAKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAvL3B1c2ggbm90ZSBpbnRvIG5vdGVzW10KICAgICAgICAgICAgICAgIHNlbGYubm90ZXMucHVzaChyZXN1bHROb3RlKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHNlbGYubm90ZXMpOwogICAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICB9OwoKICAgICAgICAgIHRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBkYi5jbG9zZSgpOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIGNvbnNvbGUubG9nKCdUQUdTJyk7CiAgICB9LAoKICAgIHVubG9hZFRhZ3MoKXsKICAgICAgdGhpcy5sb2FkRGF0YSgpOwogICAgICB0aGlzLmxhYmVscz1bXTsKICAgICAgdGhpcy5zZWxlY3RlZExhYmVsPSdBbGwgbm90ZXMnOwogICAgfSwKCiAgICAvL2NvdW50cyBob3cgbWFueSByZW1pbmRlcnMgZXhwaXJlZAogICAgbG9hZE5vdGlmaWNhdGlvbnMoKXsKICAgICAgdGhpcy5ub3RpZmljYXRpb25zPTA7CiAgICAgIAogICAgICAKICAgICAgbGV0IHNlbGY9dGhpczsKICAgICAgY29uc3QgaW5kZXhlZERCID0gd2luZG93LmluZGV4ZWREQiB8fCB3aW5kb3cubW96SW5kZXhlZERCIHx8d2luZG93LndlYmtpdEluZGV4ZWREQiB8fHdpbmRvdy5tc0luZGV4ZWREQiB8fHdpbmRvdy5zaGltSW5kZXhlZERCOwogICAgICAgIAogICAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oInRvZG9EYXRhYmFzZSIsIDEpOwogICAgICAgIAogICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpewogICAgICAgICAgY29uc29sZS5sb2coImRhdGFiYXNlIHRlc3QgY3JlYXRpb24gZXJyb3IiKTsKICAgICAgfQoKICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgIHZhciBvYmplY3RTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKCJub3RlcyIse2tleVBhdGggOiJpZCIsICBhdXRvSW5jcmVtZW50OnRydWV9KTsKICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdsYWJlbEluZGV4Jywnbm90ZS5sYWJlbFRleHQnLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ25vdGVJbmRleCcsWydub3RlLnRleHQnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdkYXRlSW5kZXgnLFsnbm90ZS5yZW1pbmRlckRhdGUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCd0aW1lSW5kZXgnLFsnbm90ZS5yZW1pbmRlclRpbWUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKCiAgICAgICAgICBjb25zb2xlLmxvZygiT2JqZWN0IHN0b3JlIENyZWF0ZWQgU3VjY2Vzc2Z1bGx5Li4uIik7CiAgICAgIH07CgoKICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCl7ICAgCiAgICAgICAgICAKICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbigibm90ZXMiKTsgICAgICAgICAgCiAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKCJub3RlcyIpOwogICAgICAgICAgbGV0IGRhdGVJbmRleCA9IG9iamVjdFN0b3JlLmluZGV4KCJkYXRlSW5kZXgiKTsKICAgICAgICAgIGxldCByZXF1ZXN0PScnOwogICAgICAgICAgcmVxdWVzdCA9IGRhdGVJbmRleC5nZXRBbGwoKTsKICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpewogICAgICAgICAgICBjb25zb2xlLmxvZygnc3VjY2VzcycpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXF1ZXN0LnJlc3VsdCk7CiAgICAgICAgICAgIGxldCByZXN1bHRzPSByZXF1ZXN0LnJlc3VsdDsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0cyk7CiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIG5vdyA9IG5vdy5nZXRUaW1lKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvcihsZXQgciBvZiByZXN1bHRzKXsKCiAgICAgICAgICAgICAvL3JlY29uc3RydWN0IGRhdGUgYW5kIHRpbWUgdG8gY29tcGFyZSBpdCB3aXRoIGN1cnJlbnQgZGF0ZSBhbmQgdGltZSAgIAogICAgICAgICAgICAgbGV0IGRhdGVUb1N0cmluZz1yLm5vdGUucmVtaW5kZXJEYXRlLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICBsZXQgYWN0dWFsRGF0ZTE9ZGF0ZVRvU3RyaW5nLnNwbGl0KCcgJyk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgYWN0dWFsRGF0ZTE9YWN0dWFsRGF0ZTFbMF0rJyAnK2FjdHVhbERhdGUxWzFdKycgJythY3R1YWxEYXRlMVsyXSsnICcrYWN0dWFsRGF0ZTFbM107CgogICAgICAgICAgICAgbGV0IHRpbWVUb1N0cmluZz1yLm5vdGUucmVtaW5kZXJUaW1lLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICBsZXQgYWN0dWFsVGltZTE9dGltZVRvU3RyaW5nLnNwbGl0KCcgJyk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgYWN0dWFsVGltZTE9YWN0dWFsVGltZTFbNF0rJyAnK2FjdHVhbFRpbWUxWzVdKycgJythY3R1YWxUaW1lMVs2XTsKICAgICAgICAgICAgIAogICAgICAgICAgICAgbGV0IGFjdHVhbERhdGVUaW1lPWFjdHVhbERhdGUxKycgJythY3R1YWxUaW1lMTsKICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFjdHVhbERhdGVUaW1lKTsKCiAgICAgICAgICAgICAvL3JlY29udmVydCB0byBEYXRlIGZvcm1hdAogICAgICAgICAgICAgYWN0dWFsRGF0ZVRpbWU9bmV3IERhdGUoYWN0dWFsRGF0ZVRpbWUpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgLy9jb21wYXJlIHdpdGggY3VycmVudCBEYXRlIGFuZCBUaW1lCiAgICAgICAgICAgICAvL2lmIHJlbWluZGVyIGhhcyBub3QgZXhwaXJlZCwgcHVzaCBub3RlIGludG8gbm90ZXNbXQogICAgICAgICAgICAgaWYoYWN0dWFsRGF0ZVRpbWUuZ2V0VGltZSgpPG5vdyl7CiAgICAgICAgICAgICAgc2VsZi5ub3RpZmljYXRpb25zKys7CiAgICAgICAgICAgICB9CiAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgfTsKCiAgICAgICAgICB0cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZGIuY2xvc2UoKTsKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAKICAgIH0sCgogICAgbG9hZEFjdGl2ZVJlbWluZGVycygpewogICAgICB0aGlzLmFjdGl2ZVJlbWluZGVycz0wOyAgCiAgICAgIHRoaXMudXBjb21pbmdSZW1pbmRlcnM9MDsKICAgICAgdGhpcy5ub3Rlcz1bXTsKICAgICAgbGV0IHNlbGY9dGhpczsKICAgICAgY29uc3QgaW5kZXhlZERCID0gd2luZG93LmluZGV4ZWREQiB8fCB3aW5kb3cubW96SW5kZXhlZERCIHx8d2luZG93LndlYmtpdEluZGV4ZWREQiB8fHdpbmRvdy5tc0luZGV4ZWREQiB8fHdpbmRvdy5zaGltSW5kZXhlZERCOwogICAgICAgIAogICAgICBjb25zdCByZXF1ZXN0ID0gaW5kZXhlZERCLm9wZW4oInRvZG9EYXRhYmFzZSIsIDEpOwogICAgICAgIAogICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpewogICAgICAgICAgY29uc29sZS5sb2coImRhdGFiYXNlIHRlc3QgY3JlYXRpb24gZXJyb3IiKTsKICAgICAgfQoKICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgIHZhciBvYmplY3RTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKCJub3RlcyIse2tleVBhdGggOiJpZCIsICBhdXRvSW5jcmVtZW50OnRydWV9KTsKICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdsYWJlbEluZGV4Jywnbm90ZS5sYWJlbFRleHQnLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ25vdGVJbmRleCcsWydub3RlLnRleHQnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdkYXRlSW5kZXgnLFsnbm90ZS5yZW1pbmRlckRhdGUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCd0aW1lSW5kZXgnLFsnbm90ZS5yZW1pbmRlclRpbWUnXSx7dW5pcXVlOmZhbHNlfSk7ICAKCiAgICAgICAgICBjb25zb2xlLmxvZygiT2JqZWN0IHN0b3JlIENyZWF0ZWQgU3VjY2Vzc2Z1bGx5Li4uIik7CiAgICAgIH07CgoKICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uIChldmVudCl7ICAgCiAgICAgICAgICAKICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbigibm90ZXMiKTsgICAgICAgICAgCiAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKCJub3RlcyIpOwogICAgICAgICAgbGV0IGRhdGVJbmRleCA9IG9iamVjdFN0b3JlLmluZGV4KCJkYXRlSW5kZXgiKTsKICAgICAgICAgIGxldCByZXF1ZXN0PScnOwogICAgICAgICAgcmVxdWVzdCA9IGRhdGVJbmRleC5nZXRBbGwoKTsKICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpewogICAgICAgICAgICBjb25zb2xlLmxvZygnc3VjY2VzcycpOwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXF1ZXN0LnJlc3VsdCk7CiAgICAgICAgICAgIGxldCByZXN1bHRzPSByZXF1ZXN0LnJlc3VsdDsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzdWx0cyk7CiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgbGV0IG5vdyA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIG5vdyA9IG5vdy5nZXRUaW1lKCk7CiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIGZvcihsZXQgciBvZiByZXN1bHRzKXsKCiAgICAgICAgICAgICAvL3JlY29uc3RydWN0IGRhdGUgYW5kIHRpbWUgdG8gY29tcGFyZSBpdCB3aXRoIGN1cnJlbnQgZGF0ZSBhbmQgdGltZSAgIAogICAgICAgICAgICAgbGV0IGRhdGVUb1N0cmluZz1yLm5vdGUucmVtaW5kZXJEYXRlLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICBsZXQgYWN0dWFsRGF0ZTE9ZGF0ZVRvU3RyaW5nLnNwbGl0KCcgJyk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgYWN0dWFsRGF0ZTE9YWN0dWFsRGF0ZTFbMF0rJyAnK2FjdHVhbERhdGUxWzFdKycgJythY3R1YWxEYXRlMVsyXSsnICcrYWN0dWFsRGF0ZTFbM107CgogICAgICAgICAgICAgbGV0IHRpbWVUb1N0cmluZz1yLm5vdGUucmVtaW5kZXJUaW1lLnRvU3RyaW5nKCk7CiAgICAgICAgICAgICBsZXQgYWN0dWFsVGltZTE9dGltZVRvU3RyaW5nLnNwbGl0KCcgJyk7ICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgYWN0dWFsVGltZTE9YWN0dWFsVGltZTFbNF0rJyAnK2FjdHVhbFRpbWUxWzVdKycgJythY3R1YWxUaW1lMVs2XTsKICAgICAgICAgICAgIAogICAgICAgICAgICAgbGV0IGFjdHVhbERhdGVUaW1lPWFjdHVhbERhdGUxKycgJythY3R1YWxUaW1lMTsKICAgICAgICAgICAgIGNvbnNvbGUubG9nKGFjdHVhbERhdGVUaW1lKTsKCiAgICAgICAgICAgICAvL3JlY29udmVydCB0byBEYXRlIGZvcm1hdAogICAgICAgICAgICAgYWN0dWFsRGF0ZVRpbWU9bmV3IERhdGUoYWN0dWFsRGF0ZVRpbWUpOwoKICAgICAgICAgICAgIAoKICAgICAgICAgICAgICBsZXQgcmVzdWx0Tm90ZT17aWQ6ci5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGV4dDpyLm5vdGUudGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxUZXh0OnIubm90ZS5sYWJlbFRleHQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsQ29sb3VyOnIubm90ZS5sYWJlbENvbG91ciwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtaW5kZXJEYXRlOnIubm90ZS5yZW1pbmRlckRhdGUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlbWluZGVyVGltZTpyLm5vdGUucmVtaW5kZXJUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5RGF0ZVRpbWU6ci5ub3RlLmRpc3BsYXlEYXRlVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNDb21wbGV0ZWQ6ci5ub3RlLmlzQ29tcGxldGVkCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAvL2NvbXBhcmUgd2l0aCBjdXJyZW50IERhdGUgYW5kIFRpbWUKICAgICAgICAgICAgIC8vaWYgcmVtaW5kZXIgaGFzIG5vdCBleHBpcmVkLCBwdXNoIG5vdGUgaW50byBub3Rlc1tdCiAgICAgICAgICAgICBpZihhY3R1YWxEYXRlVGltZS5nZXRUaW1lKCk8bm93KXsKICAgICAgICAgICAgICBzZWxmLm5vdGVzLnB1c2gocmVzdWx0Tm90ZSk7CiAgICAgICAgICAgICAgc2VsZi5hY3RpdmVSZW1pbmRlcnMrKzsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLm5vdGVzKTsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgc2VsZi51cGNvbWluZ1JlbWluZGVycysrOwogICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICB9ICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICB9OwoKICAgICAgICAgIHRyYW5zYWN0aW9uLm9uY29tcGxldGUgPSBmdW5jdGlvbiAoKSB7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBkYi5jbG9zZSgpOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIAogICAgfSwKCgoKICAgIGxvYWRVcGNvbWluZ1JlbWluZGVycygpewoKICAgICAgdGhpcy5ub3Rlcz1bXTsKICAgICAgdGhpcy51cGNvbWluZ1JlbWluZGVycz0wOwogICAgICB0aGlzLmFjdGl2ZVJlbWluZGVycz0wOyAgCiAgICAgIAogICAgICBsZXQgc2VsZj10aGlzOwogICAgICBjb25zdCBpbmRleGVkREIgPSB3aW5kb3cuaW5kZXhlZERCIHx8IHdpbmRvdy5tb3pJbmRleGVkREIgfHx3aW5kb3cud2Via2l0SW5kZXhlZERCIHx8d2luZG93Lm1zSW5kZXhlZERCIHx8d2luZG93LnNoaW1JbmRleGVkREI7CiAgICAgICAgCiAgICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbigidG9kb0RhdGFiYXNlIiwgMSk7CiAgICAgICAgCiAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICBjb25zb2xlLmxvZygiZGF0YWJhc2UgdGVzdCBjcmVhdGlvbiBlcnJvciIpOwogICAgICB9CgogICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICB2YXIgZGIgPSBldmVudC50YXJnZXQucmVzdWx0OwogICAgICAgICAgdmFyIG9iamVjdFN0b3JlID0gZGIuY3JlYXRlT2JqZWN0U3RvcmUoIm5vdGVzIix7a2V5UGF0aCA6ImlkIiwgIGF1dG9JbmNyZW1lbnQ6dHJ1ZX0pOwogICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2xhYmVsSW5kZXgnLCdub3RlLmxhYmVsVGV4dCcse3VuaXF1ZTpmYWxzZX0pOyAgCiAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnbm90ZUluZGV4JyxbJ25vdGUudGV4dCddLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2RhdGVJbmRleCcsWydub3RlLnJlbWluZGVyRGF0ZSddLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ3RpbWVJbmRleCcsWydub3RlLnJlbWluZGVyVGltZSddLHt1bmlxdWU6ZmFsc2V9KTsgIAoKICAgICAgICAgIGNvbnNvbGUubG9nKCJPYmplY3Qgc3RvcmUgQ3JlYXRlZCBTdWNjZXNzZnVsbHkuLi4iKTsKICAgICAgfTsKCgogICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KXsgICAKICAgICAgICAgIAogICAgICAgICAgdmFyIGRiID0gZXZlbnQudGFyZ2V0LnJlc3VsdDsKICAgICAgICAgIGxldCB0cmFuc2FjdGlvbiA9IGRiLnRyYW5zYWN0aW9uKCJub3RlcyIpOyAgICAgICAgICAKICAgICAgICAgIGNvbnN0IG9iamVjdFN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoIm5vdGVzIik7CiAgICAgICAgICBsZXQgZGF0ZUluZGV4ID0gb2JqZWN0U3RvcmUuaW5kZXgoImRhdGVJbmRleCIpOwogICAgICAgICAgbGV0IHJlcXVlc3Q9Jyc7CiAgICAgICAgICByZXF1ZXN0ID0gZGF0ZUluZGV4LmdldEFsbCgpOwogICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICByZXF1ZXN0Lm9uc3VjY2VzcyA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdWNjZXNzJyk7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcXVlc3QucmVzdWx0KTsKICAgICAgICAgICAgbGV0IHJlc3VsdHM9IHJlcXVlc3QucmVzdWx0OwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXN1bHRzKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBsZXQgbm93ID0gbmV3IERhdGUoKTsKICAgICAgICAgICAgbm93ID0gbm93LmdldFRpbWUoKTsKICAgICAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgZm9yKGxldCByIG9mIHJlc3VsdHMpewoKICAgICAgICAgICAgIC8vcmVjb25zdHJ1Y3QgZGF0ZSBhbmQgdGltZSB0byBjb21wYXJlIGl0IHdpdGggY3VycmVudCBkYXRlIGFuZCB0aW1lICAgCiAgICAgICAgICAgICBsZXQgZGF0ZVRvU3RyaW5nPXIubm90ZS5yZW1pbmRlckRhdGUudG9TdHJpbmcoKTsKICAgICAgICAgICAgIGxldCBhY3R1YWxEYXRlMT1kYXRlVG9TdHJpbmcuc3BsaXQoJyAnKTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICBhY3R1YWxEYXRlMT1hY3R1YWxEYXRlMVswXSsnICcrYWN0dWFsRGF0ZTFbMV0rJyAnK2FjdHVhbERhdGUxWzJdKycgJythY3R1YWxEYXRlMVszXTsKCiAgICAgICAgICAgICBsZXQgdGltZVRvU3RyaW5nPXIubm90ZS5yZW1pbmRlclRpbWUudG9TdHJpbmcoKTsKICAgICAgICAgICAgIGxldCBhY3R1YWxUaW1lMT10aW1lVG9TdHJpbmcuc3BsaXQoJyAnKTsgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICBhY3R1YWxUaW1lMT1hY3R1YWxUaW1lMVs0XSsnICcrYWN0dWFsVGltZTFbNV0rJyAnK2FjdHVhbFRpbWUxWzZdOwogICAgICAgICAgICAgCiAgICAgICAgICAgICBsZXQgYWN0dWFsRGF0ZVRpbWU9YWN0dWFsRGF0ZTErJyAnK2FjdHVhbFRpbWUxOwogICAgICAgICAgICAgY29uc29sZS5sb2coYWN0dWFsRGF0ZVRpbWUpOwoKICAgICAgICAgICAgIC8vcmVjb252ZXJ0IHRvIERhdGUgZm9ybWF0CiAgICAgICAgICAgICBhY3R1YWxEYXRlVGltZT1uZXcgRGF0ZShhY3R1YWxEYXRlVGltZSk7CgogICAgICAgICAgICAgCgogICAgICAgICAgICAgIGxldCByZXN1bHROb3RlPXtpZDpyLmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0ZXh0OnIubm90ZS50ZXh0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbFRleHQ6ci5ub3RlLmxhYmVsVGV4dCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxDb2xvdXI6ci5ub3RlLmxhYmVsQ29sb3VyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1pbmRlckRhdGU6ci5ub3RlLnJlbWluZGVyRGF0ZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtaW5kZXJUaW1lOnIubm90ZS5yZW1pbmRlclRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlEYXRlVGltZTpyLm5vdGUuZGlzcGxheURhdGVUaW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0NvbXBsZXRlZDpyLm5vdGUuaXNDb21wbGV0ZWQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgIC8vY29tcGFyZSB3aXRoIGN1cnJlbnQgRGF0ZSBhbmQgVGltZQogICAgICAgICAgICAgLy9pZiByZW1pbmRlciBoYXMgZXhwaXJlZCwgcHVzaCBub3RlIGludG8gbm90ZXNbXQogICAgICAgICAgICAgaWYoYWN0dWFsRGF0ZVRpbWUuZ2V0VGltZSgpPm5vdyl7CiAgICAgICAgICAgICAgc2VsZi5ub3Rlcy5wdXNoKHJlc3VsdE5vdGUpOwogICAgICAgICAgICAgIHNlbGYudXBjb21pbmdSZW1pbmRlcnMrKzsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhzZWxmLm5vdGVzKTsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgIGVsc2V7CiAgICAgICAgICAgICAgc2VsZi5hY3RpdmVSZW1pbmRlcnMrKzsKICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgfSAgICAgICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgfTsKCiAgICAgICAgICB0cmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24gKCkgeyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgZGIuY2xvc2UoKTsKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICAvLwogICAgfSwKCiAgICB0b2dnbGVSZW1pbmRlcnMobil7CiAgICAgIAogICAgICBpZihuPT0xKXsKICAgICAgICB0aGlzLmlzQWN0aXZlUmVtaW5kZXI9dHJ1ZTsKICAgICAgICB0aGlzLmlzVXBjb21pbmdSZW1pbmRlcj1mYWxzZTsKICAgICAgICB0aGlzLmxvYWRBY3RpdmVSZW1pbmRlcnMoKTsKICAgICAgfQogICAgICBlbHNlewogICAgICAgIHRoaXMuaXNBY3RpdmVSZW1pbmRlcj1mYWxzZTsKICAgICAgICB0aGlzLmlzVXBjb21pbmdSZW1pbmRlcj10cnVlOwogICAgICAgIHRoaXMubG9hZFVwY29taW5nUmVtaW5kZXJzKCk7CiAgICAgIH0KCiAgICAgIAoKICAgIH0sCgogICAgLy9tYXJrcyBub3RlIGFzIGNvbXBsZXRlZAogICAgbWFya0NvbXBsZXRlZChub3RlSWQpewogICAgICAvLwogICAgICAKCiAgICAgICAgbGV0IHNlbGY9dGhpczsKICAgICAgICBjb25zdCBpbmRleGVkREIgPSB3aW5kb3cuaW5kZXhlZERCIHx8IHdpbmRvdy5tb3pJbmRleGVkREIgfHx3aW5kb3cud2Via2l0SW5kZXhlZERCIHx8d2luZG93Lm1zSW5kZXhlZERCIHx8d2luZG93LnNoaW1JbmRleGVkREI7CiAgICAgICAgCiAgICAgICAgY29uc3QgcmVxdWVzdCA9IGluZGV4ZWREQi5vcGVuKCJ0b2RvRGF0YWJhc2UiLCAxKTsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgcmVxdWVzdC5vbmVycm9yID0gZnVuY3Rpb24oKXsKICAgICAgICAgICAgY29uc29sZS5sb2coInJlcXVlc3QgZXJyb3IgLSBtYXJrQ29tcGxldGVkIik7CiAgICAgICAgfQoKICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7CiAgICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICAgIHZhciBvYmplY3RTdG9yZSA9IGRiLmNyZWF0ZU9iamVjdFN0b3JlKCJub3RlcyIse2tleVBhdGggOiJpZCIsICBhdXRvSW5jcmVtZW50OnRydWV9KTsKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2xhYmVsSW5kZXgnLFsnbm90ZS5sYWJlbFRleHQnXSx7dW5pcXVlOmZhbHNlfSk7ICAKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ25vdGVJbmRleCcsWydub3RlLnRleHQnXSx7dW5pcXVlOmZhbHNlfSk7IAogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgnZGF0ZUluZGV4JyxbJ25vdGUucmVtaW5kZXJEYXRlJ10se3VuaXF1ZTpmYWxzZX0pOyAgCiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCd0aW1lSW5kZXgnLFsnbm90ZS5yZW1pbmRlclRpbWUnXSx7dW5pcXVlOmZhbHNlfSk7ICAgCiAgICAgICAgICAgIAogICAgICAgICAgICBjb25zb2xlLmxvZygiT2JqZWN0IHN0b3JlIENyZWF0ZWQgU3VjY2Vzc2Z1bGx5Li4uIik7CiAgICAgICAgfTsKICAgICAgCiAgICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZXZlbnQpeyAgICAgICAKICAgICAgICAgIHZhciBkYiA9IGV2ZW50LnRhcmdldC5yZXN1bHQ7CiAgICAgICAgICBsZXQgdHJhbnNhY3Rpb24gPSBkYi50cmFuc2FjdGlvbigibm90ZXMiLCJyZWFkd3JpdGUiKTsKICAgICAgICAgIGNvbnN0IG9iamVjdFN0b3JlID0gdHJhbnNhY3Rpb24ub2JqZWN0U3RvcmUoIm5vdGVzIik7CgogICAgICAgICAgLy9nZXQgcmVjb3JkIHRvIG1vZGlmeQogICAgICAgICAgY29uc3QgcmVjb3JkUmVxdWVzdCA9IG9iamVjdFN0b3JlLmdldChub3RlSWQpOwoKICAgICAgICAgIHJlY29yZFJlcXVlc3Qub25zdWNjZXNzPWZ1bmN0aW9uKCl7CgogICAgICAgICAgICBsZXQgcmVjb3JkID0gcmVjb3JkUmVxdWVzdC5yZXN1bHQ7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlY29yZCk7ICAgIAogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAvLyByZWNvcmQubm90ZS50ZXh0ID0gdGV4dDsKICAgICAgICAgICAgLy8gcmVjb3JkLm5vdGUucmVtaW5kZXJEYXRlPXJlbWluZGVyRGF0ZTsKICAgICAgICAgICAgLy8gcmVjb3JkLm5vdGUucmVtaW5kZXJUaW1lPXJlbWluZGVyVGltZTsKICAgICAgICAgICAgLy8gcmVjb3JkLm5vdGUuZGlzcGxheURhdGVUaW1lPWRpc3BsYXlEYXRlVGltZTsgICAgICAgICAgICAKICAgICAgICAgICAgLy8gcmVjb3JkLm5vdGUubGFiZWxUZXh0PWxhYmVsVGV4dDsKICAgICAgICAgICAgLy8gcmVjb3JkLm5vdGUubGFiZWxDb2xvdXI9bGFiZWxDb2xvdXI7CiAgICAgICAgICAgIHJlY29yZC5ub3RlLmlzQ29tcGxldGVkPXRydWU7CgoKICAgICAgICAgICAgLy9zYXZlIG5ldyB2YWx1ZXMgdG8gaW5kZXhlZERCCiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZVJlcXVlc3Q9b2JqZWN0U3RvcmUucHV0KHJlY29yZCk7CgogICAgICAgICAgICB1cGRhdGVSZXF1ZXN0Lm9uc3VjY2Vzcz1mdW5jdGlvbigpewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZWNvcmQgdXBkYXRlZCcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgfQogICAgICAgICAgdHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIAogICAgICAgICAgICAvL3Nob3cgYWxsIG5vdGVzIChmaWx0ZXJlZCBieSB0YWcgb3Igbm90KQogICAgICAgICAgICBpZihzZWxmLm9wdGlvbj09MSl7CiAgICAgICAgICAgICAgaWYoc2VsZi5pc1RhZ1NlYXJjaCl7ICAgIAogICAgICAgICAgICAgICAgaWYoc2VsZi5zZWxlY3RlZExhYmVsIT0nQWxsIG5vdGVzJyl7CiAgICAgICAgICAgICAgICAgIHNlbGYuc2VsZWN0ZWRMYWJlbD1zZWxmLnNlbGVjdGVkTm90ZVswXS5sYWJlbFRleHQ7ICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9ICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgIHNlbGYubG9hZFRhZ3MoKTsgIAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgc2VsZi5sb2FkRGF0YSgpOyAgCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIC8vc2hvdyBub3RlcyB3aXRoIHJlbWluZGVycwogICAgICAgICAgICBlbHNlIGlmIChzZWxmLm9wdGlvbj09Mil7CiAgICAgICAgICAgICAgIGlmKHNlbGYuaXNBY3RpdmVSZW1pbmRlcil7CiAgICAgICAgICAgICAgICBzZWxmLmxvYWRBY3RpdmVSZW1pbmRlcnMoKTsKICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBlbHNlewogICAgICAgICAgICAgICAgc2VsZi5sb2FkVXBjb21pbmdSZW1pbmRlcnMoKTsKICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAKICAgICAgICAgICAgfQogICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICBkYi5jbG9zZSgpOwogICAgICAgICAgICBzZWxmLmlzTm90ZU9wdGlvbnM9ZmFsc2U7CiAgICAgICAgICB9OwoKCiAgICAgICAgICB9OwoKCgoKICAgIH0sCgogICAgbWFya0luY29tcGxldGUobm90ZUlkKXsKICAgICAgLy8KICAgICAgIGxldCBzZWxmPXRoaXM7CiAgICAgICAgY29uc3QgaW5kZXhlZERCID0gd2luZG93LmluZGV4ZWREQiB8fCB3aW5kb3cubW96SW5kZXhlZERCIHx8d2luZG93LndlYmtpdEluZGV4ZWREQiB8fHdpbmRvdy5tc0luZGV4ZWREQiB8fHdpbmRvdy5zaGltSW5kZXhlZERCOwogICAgICAgIAogICAgICAgIGNvbnN0IHJlcXVlc3QgPSBpbmRleGVkREIub3BlbigidG9kb0RhdGFiYXNlIiwgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uKCl7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJyZXF1ZXN0IGVycm9yIC0gbWFya0NvbXBsZXRlZCIpOwogICAgICAgIH0KCiAgICAgICAgcmVxdWVzdC5vbnVwZ3JhZGVuZWVkZWQgPSBmdW5jdGlvbihldmVudCkgewogICAgICAgICAgICB2YXIgZGIgPSBldmVudC50YXJnZXQucmVzdWx0OwogICAgICAgICAgICB2YXIgb2JqZWN0U3RvcmUgPSBkYi5jcmVhdGVPYmplY3RTdG9yZSgibm90ZXMiLHtrZXlQYXRoIDoiaWQiLCAgYXV0b0luY3JlbWVudDp0cnVlfSk7CiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdsYWJlbEluZGV4JyxbJ25vdGUubGFiZWxUZXh0J10se3VuaXF1ZTpmYWxzZX0pOyAgCiAgICAgICAgICAgIG9iamVjdFN0b3JlLmNyZWF0ZUluZGV4KCdub3RlSW5kZXgnLFsnbm90ZS50ZXh0J10se3VuaXF1ZTpmYWxzZX0pOyAKICAgICAgICAgICAgb2JqZWN0U3RvcmUuY3JlYXRlSW5kZXgoJ2RhdGVJbmRleCcsWydub3RlLnJlbWluZGVyRGF0ZSddLHt1bmlxdWU6ZmFsc2V9KTsgIAogICAgICAgICAgICBvYmplY3RTdG9yZS5jcmVhdGVJbmRleCgndGltZUluZGV4JyxbJ25vdGUucmVtaW5kZXJUaW1lJ10se3VuaXF1ZTpmYWxzZX0pOyAgIAogICAgICAgICAgICAKICAgICAgICAgICAgY29uc29sZS5sb2coIk9iamVjdCBzdG9yZSBDcmVhdGVkIFN1Y2Nlc3NmdWxseS4uLiIpOwogICAgICAgIH07CiAgICAgIAogICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24gKGV2ZW50KXsgICAgICAgCiAgICAgICAgICB2YXIgZGIgPSBldmVudC50YXJnZXQucmVzdWx0OwogICAgICAgICAgbGV0IHRyYW5zYWN0aW9uID0gZGIudHJhbnNhY3Rpb24oIm5vdGVzIiwicmVhZHdyaXRlIik7CiAgICAgICAgICBjb25zdCBvYmplY3RTdG9yZSA9IHRyYW5zYWN0aW9uLm9iamVjdFN0b3JlKCJub3RlcyIpOwoKICAgICAgICAgIC8vZ2V0IHJlY29yZCB0byBtb2RpZnkKICAgICAgICAgIGNvbnN0IHJlY29yZFJlcXVlc3QgPSBvYmplY3RTdG9yZS5nZXQobm90ZUlkKTsKCiAgICAgICAgICByZWNvcmRSZXF1ZXN0Lm9uc3VjY2Vzcz1mdW5jdGlvbigpewoKICAgICAgICAgICAgbGV0IHJlY29yZCA9IHJlY29yZFJlcXVlc3QucmVzdWx0OwogICAgICAgICAgICBjb25zb2xlLmxvZyhyZWNvcmQpOyAgICAKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgcmVjb3JkLm5vdGUuaXNDb21wbGV0ZWQ9ZmFsc2U7CgoKICAgICAgICAgICAgLy9zYXZlIG5ldyB2YWx1ZXMgdG8gaW5kZXhlZERCCiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZVJlcXVlc3Q9b2JqZWN0U3RvcmUucHV0KHJlY29yZCk7CgogICAgICAgICAgICB1cGRhdGVSZXF1ZXN0Lm9uc3VjY2Vzcz1mdW5jdGlvbigpewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyZWNvcmQgdXBkYXRlZCcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIAogICAgICAgICAgfQogICAgICAgICAgdHJhbnNhY3Rpb24ub25jb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgCgogICAgICAgICAgICAvL3Nob3cgYWxsIG5vdGVzIChmaWx0ZXJlZCBieSB0YWcgb3Igbm90KQogICAgICAgICAgICBpZihzZWxmLm9wdGlvbj09MSl7CiAgICAgICAgICAgICAgaWYoc2VsZi5pc1RhZ1NlYXJjaCl7ICAgIAogICAgICAgICAgICAgICAgY29uc29sZS5sb2coc2VsZi5zZWxlY3RlZExhYmVsKTsgICAgICAKICAgICAgICAgICAgICAgIGlmKHNlbGYuc2VsZWN0ZWRMYWJlbCE9J0FsbCBub3RlcycpewogICAgICAgICAgICAgICAgICAvLyBzZWxmLnNlbGVjdGVkTGFiZWw9c2VsZi5sYWJlbFRleHQ7IAogICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhzZWxmLnNlbGVjdGVkTGFiZWwpOyAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgfSAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICBzZWxmLmxvYWRUYWdzKCk7ICAKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIHNlbGYubG9hZERhdGEoKTsgIAogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAvL3Nob3cgbm90ZXMgd2l0aCByZW1pbmRlcnMKICAgICAgICAgICAgZWxzZSBpZiAoc2VsZi5vcHRpb249PTIpewogICAgICAgICAgICAgICBpZihzZWxmLmlzQWN0aXZlUmVtaW5kZXIpewogICAgICAgICAgICAgICAgc2VsZi5sb2FkQWN0aXZlUmVtaW5kZXJzKCk7CiAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgZWxzZXsKICAgICAgICAgICAgICAgIHNlbGYubG9hZFVwY29taW5nUmVtaW5kZXJzKCk7CiAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgIGRiLmNsb3NlKCk7CiAgICAgICAgICAgIHNlbGYuaXNOb3RlT3B0aW9ucz1mYWxzZTsKICAgICAgICAgIH07CgoKICAgICAgICAgIH07CiAgICB9CgogIH0KCn0K"},{"version":3,"sources":["Main.vue"],"names":[],"mappings":";AA2fA;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;;AAEA;AACA;;;;AAIA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;;AAEA;;;AAGA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;;;;AAIA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;;;AAIA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;;;AAIA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;;;;AAKA;;;;AAIA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;;;;AAIA;AACA;;AAEA;;;;AAIA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;AAMA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;;;AAIA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;;AAIA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;;;AAGA;;;;;AAKA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA","file":"Main.vue","sourceRoot":"src/components","sourcesContent":["\n\n\n\n<template>\n  <div class='container'>\n    <div class='container'>\n      <div class=\"row shadow top2\" id=\"header\">\n        <a href=\"/\"><img  class=\"logo\" src=\"../assets/logo.png\" alt=\"logo\">      </a>\n      </div>\n\n      \n      <h1 class=\"row\"><span class='section-title'></span></h1>\n  \n      <div class=\"row top2 mainContainer py-0 py-md-2\" id=\"topmenu\">\n          <button v-if='option==1' class=\"col-6 col-md-1 m-md-1 btn btn-primary\" @click='setOption(1)'><i class=\"far fa-sticky-note\"></i></button>\n          <button v-if='option!=1' class=\"col-6 col-md-1 m-md-1 btn btn-light\" @click='setOption(1)'><i class=\"far fa-sticky-note\"></i></button>\n          <button v-if='option==2 && notifications==0' class=\"col-6 col-md-1 m-md-1  btn btn-primary\" @click='setOption(2)'><i class=\"fas fa-bell\"></i></button>\n          <button v-if='option!=2 && notifications==0' class=\"col-6 col-md-1 m-md-1 btn btn-light\" @click='setOption(2)'><i class=\"fas fa-bell\"></i></button>\n  \n          <button v-if='option==2 && notifications>0' class=\"col-6 col-md-1 m-md-1 btn btn-primary\" @click='setOption(2)'><i class=\"fas fa-bell\"> </i> <small class='notification left1'> <b>({{notifications}})</b></small></button> \n          <button v-if='option!=2 && notifications>0' class=\"col-6 col-md-1 m-md-1 btn btn-light\" @click='setOption(2)'><i class=\"fas fa-bell\"> </i> <small class='notification left1'> <b>({{notifications}})</b></small></button>  \n      </div>\n  \n  \n     <div v-if=\"option==1\"  class=\"row top2 mainContainer\">\n        <button class=\"btn btn-primary2 fas fa-plus \" @click='addNew'></button>            \n        <button v-if=\"isTagSearch==false\"  class=\"left1 btn black \" @click=\"toggleTagSearch\"><i class=\"fas fa-tag\"></i> group</button>         \n        <button v-if=\"isTagSearch\"  class=\"left1 btn btn-primary2 \" @click=\"toggleTagSearch\"><i class=\"fas fa-tag\"></i> group</button>               \n        <button class=\"btn lightgrey system\"><small>click on the notes for options</small></button>\n     </div> \n  \n     \n  \n     <div v-if=\"option==1 && enableAdd\"  class=\"row top1 mainContainer\">\n        <input v-if='enableAdd' class=\"col-10 black\"  type=\"text\" ref=\"newNoteInput\">  \n    \n        <button v-if=\"!enabledLabel\" class=\"col-12 col-md btn \" @click='toggleLabel' ><i class=\"fas fa-tag\"></i></button>      \n        <!-- <button v-if=\"enabledLabel\"  class=\"col-12 col-md btn border-bottom \" @click='toggleLabel' ><i class=\"fas fa-tag\"></i></button>       -->\n        <!-- <button v-if=\"enabledNotification\" class=\"col-12 col-md btn invisible \">aaa</button> -->\n        <button v-if=\"!enabledNotification\" class=\"col-12 col-md btn \" @click='toggleNotification' ><i class=\"fas fa-bell\"></i></button>\n        \n        <transition>\n          <div v-if='enabledLabel' class=\"modalContainer centre\">\n            <div  class=\"col-12 modal1 \">\n  \n              <h2 class=\"col-12 black\"><i class=\"fas fa-tag\"></i> </h2>  \n              \n              <div class=\"col-12 top1 black\"><small><b>Add label</b></small></div>\n              <input class=\"col-10 top1\" type=\"text\" id=\"input_label\"\n              :style=\"{ color: this.colour}\"\n              >   \n              <v-swatches class=\"top1\"\n              v-model=\"colour\"                              \n              shapes=\"circles\"\n                >\n              </v-swatches>\n              <button class=\"col-10 top1 btn btn-light\" @click='addLabel'>ok</button>\n              <button class=\"col-10 top1  btn black \" @click='toggleLabel'>cancel</button>\n              <!-- <button class=\"btn col\">cancel</button> -->             \n            </div>\n          </div>\n        </transition>\n  \n        <div class=\"col-12 top1\">                  \n            <button v-if=\"labelText!=''\" class=\"btn btn-light fas fa-tag\" :style=\"{color: labelColour}\" @click='deleteLabel()'><small> {{labelText}} -</small></button>\n            <button v-if=\"reminderDate!=null\" class=\"btn darkcyan left1\" @click=\"deleteReminder\" :title=displayDateTime> <i class=\"fas fa-bell\"><small> {{displayDateTime}}  <i class=\"fas fa-trash-alt\"></i></small></i></button>          \n            \n        </div>\n  \n        \n  \n         <transition>\n            <div v-if='enabledNotification' class=\"modalContainer\">\n              <div  class=\"col-12 centre modal1\">\n                <h2 class=\"col-12 black\"><i class=\"fas fa-bell\"></i> </h2> \n                <div class=\"col-12 black\"><small><b>Add Reminder</b></small></div>\n  \n                \n                  <div class=\"col\">\n                    <date-picker id=\"datePicker\"\n                      v-model=\"reminderDate\"\n                      type=\"date\"\n                      format='DD-MM-YYYY'\n                      placeholder=\"Reminder date\"\n                      :editable=false\n                      confirm=true\n                      confirm-text='ok'\n                      >\n                        \n                    </date-picker>\n                  </div>\n  \n                  <div v-if=\"reminderDate!=null\" class=\"col top2\" >\n  \n                    <!-- time picker -->\n                    <date-picker id=\"timePicker\"\n                      v-model=\"reminderTime\"\n                      type=\"time\"\n                      format='HH:mm'\n                      placeholder=\"Reminder time \"\n                      :editable=false\n                      confirm=true\n                      confirm-text='ok'\n                      :clearable=true\n    \n                      :time-picker-options=\"{\n                        start: '00:00',\n                        step: '00:30',\n                        end: '23:30',\n                      }\"\n                      >    \n                    </date-picker>\n  \n                    <!-- no time selected -->\n                    \n                  </div>   \n  \n                  <div class=\"col-12 top1  red\" v-if=\"timeNull\"><small>Please select reminder time</small></div>                       \n  \n                <button class=\"col-10 top1 btn btn-light primary\" @click='addReminder'>add</button>\n                <button class=\"col-10 top1  btn black\" @click='toggleNotification'>cancel</button>\n              </div>  \n            </div>  \n         </transition>\n        \n        <button v-if=\"!this.enabledLabel && !this.enabledNotification\" class=\"col-12 top2 btn btn-primary\" @click='saveNew'>add</button>\n        <button v-if=\"!this.enabledLabel && !this.enabledNotification\"  class=\"col-12 top2 btn btn-primary2 black\" @click='closeAdd'>cancel</button>\n     </div> \n  \n     <div v-if=\"option==1 && !enableAdd\" id=\"notesContainer\" class=\"container top1\" >\n        \n        <!-- filter by labels is off -->\n        <span v-if=\"!isNoteOptions && !isEdit && !isTagSearch\">\n          <draggable v-model=\"notes\"  @end=\"resort\">\n          <div class=\"row  button  black top1\" v-for=\"(n,index) in notes\" :key=\"index\">\n            \n            <!-- <button class=\"btn btn-light2 left col black\" @click='toggleNoteOptions(index, n.id)'>{{index}} {{n.text}} {{n.id}} </button>                     -->\n            <template v-if=\"n.isCompleted==false\"> \n            <button class=\"btn btn-light2 left col black\" @click='toggleNoteOptions(index, n.id)'>{{n.text}}  </button>                    \n            <button v-if=\"n.labelText!=''\" class=\"btn btn-light2 left\" :style=\"{color: n.labelColour}\" :title=n.labelText> <i class=\"fas fa-tag\"> <small> {{n.labelText}}</small></i></button>\n            <button  v-if='n.reminderDate!=null' class=\"btn btn-light2 darkcyan\" :title=n.displayDateTime ><i class=\"fas fa-bell\"></i></button>\n            <button  v-if='n.reminderDate==null' class=\" btn btn-light2 darkcyan\" ><i class=\"fas fa-bell invisible\" ></i></button>                                                           \n            </template>\n  \n            <!-- if task is completed -->\n            <template v-if=\"n.isCompleted==true\">            \n            <button class=\"btn btn-light2 left col system\">{{n.text}}  </button>                                                                                \n            <button class=\"btn btn-light2 left col-1 green\" @click='markIncomplete(n.id)'><i class=\"fas fa-check-double\"></i></button>\n            <button class=\"btn btn-light2  col-1  black\" @click='deleteNote(n.id,complete=true)' ><i class=\"fa fa-trash\"></i></button>\n            </template>\n  \n  \n          </div>   \n         </draggable> \n  \n         <div v-if=\"notes==''\"  class=\"row  top1\">          \n              <p class=\"left1  primary2\">No notes found</p>\n         </div> \n        </span>\n  \n  \n        <!-- filter by labels is on -->\n         <div v-if=\"!isNoteOptions && !isEdit && isTagSearch\">\n          \n          <div class=\"row sticky-top membrane2\">\n            \n            <i class=\"left1 fas fa-tag fa-xs margin-v-auto\"></i>\n            <select v-model=\"selectedLabel\" class=\"left2  top1 \"   name=\"tagFilter\"  id=\"tagFilter\" @change=\"loadTags()\">\n              \n              <option class=\"primary \" v-for=\"(l,index) in labels\" :value=\"l\" :key=\"index\">                  \n  \n                <template v-if=\"l==''\">\n                  No label    \n                </template>\n  \n                <template v-if=\"l!=''\">\n                  {{ l }}    \n                </template>\n                 \n              </option>        \n            </select>\n            \n          </div> \n  \n                 \n            <div class=\"row   button  black top1\" v-for=\"(n,index) in notes\" :key=\"index\">          \n              <template v-if=\"n.isCompleted==false\">       \n                <button class=\"btn btn-light2 left col black\" @click='toggleNoteOptions(index, n.id)'>{{n.text}}  </button>                    \n                <button v-if=\"n.labelText!=''\" class=\" btn btn-light2 left\" :style=\"{color: n.labelColour}\" :title=n.labelText> <i class=\"fas fa-tag\"> <small> {{n.labelText}}</small></i></button>\n                <button v-if=\"n.labelText==''\" class=\" btn btn-light2 left\"  :title=n.labelText></button>\n                <button  v-if='n.reminderDate!=null' class=\" btn btn-light2 darkcyan\" :title=n.displayDateTime ><i class=\"fas fa-bell\"></i></button>\n                <button  v-if='n.reminderDate==null' class=\" btn btn-light2 darkcyan\" ><i class=\"fas fa-bell invisible\" ></i></button>                                         \n              </template>\n  \n  \n  \n              <template v-if=\"n.isCompleted==true\">   \n                <button class=\"btn btn-light2 left col system\">{{n.text}}  </button>\n                <button v-if=\"n.labelText!=''\" class=\" btn btn-light2 system left\" :title=n.labelText> <i class=\"fas fa-tag\"> <small> {{n.labelText}}</small></i></button>\n                <button v-if=\"n.labelText==''\" class=\" btn btn-light2 system left\"  :title=n.labelText></button>\n                <button  v-if='n.reminderDate!=null' class=\" btn btn-light2  system\" :title=n.displayDateTime ><i class=\"fas fa-bell\"></i></button>\n                <button  v-if='n.reminderDate==null' class=\" btn btn-light2 system\" ><i class=\"fas fa-bell invisible\" ></i></button>                                                                                                                         \n                <button class=\"btn btn-light2 left col-1 green\" @click='markIncomplete(n.id)'><i class=\"fas fa-check-double\"></i></button>                  \n                <button class=\"btn btn-light2 col-1  black\" @click='deleteNote(n.id,complete=true)' ><i class=\"fa fa-trash\"></i></button>\n                </template >\n            </div>   \n  \n  \n            <div v-if=\"notes==''\"  class=\"row top1 left1  button  black top1\">          \n              <p class=\" primary2\">No notes found</p>                         \n            </div> \n          \n  \n         \n         </div>\n        \n  \n         <span v-if=\"isNoteOptions\">\n            <div class=\"row  shadow  button  black top1\">\n              <button class=\"btn  left col black\" @click='toggleNoteOptions(noteIndex,noteId)'> {{notes[noteIndex].text}}</button>\n              <button class=\"btn  col-2  green\" @click='markCompleted(noteId)' ><i class=\"fas fa-check\"></i> <small> completed</small></button>\n              <button class=\"btn  col-1  black\" @click='toggleEdit' ><i class=\"far fa-edit\"></i></button>            \n              <button class=\"btn  col-1  black\" @click='deleteNote(noteId)' ><i class=\"fa fa-trash\"></i></button>            \n              \n            </div>  \n          </span> \n  \n          <span v-if=\"isEdit\">\n            <div class=\"row  button  black top1\">\n              <input  class=\"col-10 black\" id=\"input_edit\" type=\"text\" :value='notes[noteIndex].text'>             \n  \n               <button v-if=\"!enabledLabel\" class=\"col-12 col-md btn \" @click=\"toggleLabel\" ><i class=\"fas fa-tag\"></i></button>            \n               <button v-if=\"!enabledNotification\" class=\"col-12 col-md btn \" @click=\"toggleNotification\" ><i class=\"fas fa-bell\"></i></button>\n            </div>  \n  \n            <div class=\"row top1\">    \n              \n              <button v-if=\"labelText!=''\" class=\"btn btn-light fas fa-tag\" :style=\"{color: labelColour}\" @click='deleteLabel()'><small> {{labelText}} -</small></button>\n              <button v-if='reminderDate!=null' class=\"btn darkcyan left left1\" @click='deleteReminder()' ><i class=\"fas fa-bell\" :title=displayDateTime><small> {{displayDateTime}} <i class=\"fas fa-trash-alt\"></i></small> </i> </button>\n              \n            </div>  \n\n            <div class=\"row\">\n              <button class=\"btn btn-primary2  top1 col-md-2\" @click='saveEdit' >ok</button>            \n              <button class=\"btn btn primary top1 col-md-2  m-md-1\" @click='toggleEdit'>cancel</button>            \n            </div>\n          </span> \n  \n          <transition>\n  \n          <div v-if='enabledLabel' class=\"modalContainer centre\">\n            <div  class=\"col-12 modal1 \">\n  \n              <h2 class=\"col-12 black\"><i class=\"fas fa-tag\"></i> </h2>  \n              \n              <div class=\"col-12 top1 black\"><small><b>Add label</b></small></div>\n              <input class=\"col-10 top1\" type=\"text\" id=\"input_label\"\n              :style=\"{ color: this.colour}\"\n              >   \n              <v-swatches class=\"top1\"\n              v-model=\"colour\"                              \n              shapes=\"circles\"\n                >\n              </v-swatches>\n              <button class=\"col-10 top1 btn btn-light\" @click='addLabel'>ok</button>\n              <button class=\"col-10 top1  btn black \" @click='toggleLabel'>cancel</button>\n              <!-- <button class=\"btn col\">cancel</button> -->             \n            </div>\n          </div>\n        </transition>\n  \n        \n  \n        \n         <transition>\n            <div v-if='enabledNotification' class=\"modalContainer\">\n              <div  class=\"col-12 centre modal1\">\n                <h2 class=\"col-12 black\"><i class=\"fas fa-bell\"></i> </h2> \n                <div class=\"col-12 black\"><small><b>Add Reminder</b></small></div>\n  \n                \n                  <div class=\"col\">\n                    <date-picker\n                      v-model=\"reminderDate\"\n                      type=\"date\"\n                      format='DD-MM-YYYY'\n                      placeholder=\"Reminder date\"\n                      :editable=false\n                      confirm=true\n                      confirm-text='ok'\n                      >\n                        \n                    </date-picker>\n  \n                    \n                  </div>\n  \n                  \n                  <div  class=\"col top2\">\n                    <date-picker \n                      v-model=\"reminderTime\"\n                      type=\"time\"\n                      format='HH:mm'\n                      placeholder=\"Reminder time \"\n                      :editable=false\n                      confirm=true\n                      confirm-text='ok'\n                      :clearable=true\n    \n                      :time-picker-options=\"{\n                        start: '00:00',\n                        step: '00:30',\n                        end: '23:30',\n                      }\"\n                      >\n                        \n                    </date-picker>\n                  </div>                          \n                <button class=\"col-10 top1 btn btn-light primary\" @click='addReminder'>add</button>\n                <button class=\"col-10 top1  btn black\" @click='toggleNotification'>cancel</button>\n                \n              </div>  \n            </div>  \n         </transition>\n     </div> \n  \n    \n    <!-- Display notes with reminder -->\n     <div v-if=\"option==2\"  class=\" top1\">      \n        <div class=\"row  sticky-top mainContainer membrane2\">\n          <button v-if='isActiveReminder' class=\"btn btn-primary2 col-6 col-md-2\" @click='toggleReminders(1)' ><b>Expired</b> <small v-if=\"activeReminders>0\" class=\"primary notification\"><b> ({{activeReminders}})</b></small></button> \n          <button v-if='!isActiveReminder' class=\"btn col-6 col-md-2\" @click='toggleReminders(1)'>Expired <small v-if=\"activeReminders>0\" class=\"primary notification\"><b> ({{activeReminders}})</b></small> </button> \n  \n          <button v-if='isUpcomingReminder' class=\"btn btn-primary2 col-6 col-md-2\" @click='toggleReminders(2)'><b>Upcoming</b> <small v-if=\"upcomingReminders>0\" class=\"primary notification\"><b> ({{upcomingReminders}})</b></small> </button>          \n          <button v-if='!isUpcomingReminder' class=\"btn col-6 col-md-2\" @click='toggleReminders(2)'>Upcoming <small v-if=\"upcomingReminders>0\" class=\"notification\" ><b> ({{upcomingReminders}})</b></small></button>\n  \n          <button class=\"btn lightgrey system col left\"><small>click on the notes for options</small></button>\n        </div>\n  \n         \n        <template  v-if=\"!isNoteOptions && !isEdit\">\n          <div class=\"notesContainer\">\n            <div  class=\"row button  black top1\" v-for=\"(n,index) in notes\" :key=\"index\">          \n                <template v-if=\"n.isCompleted==false\">\n                <button class=\"btn btn-light2 left col black\" @click='toggleNoteOptions(index, n.id)'>{{n.text}}  </button>                \n                <button v-if=\"n.labelText!=''\" class=\" btn btn-light2 left\" :style=\"{color: n.labelColour}\" :title=n.labelText> <i class=\"fas fa-tag\"> <small> {{n.labelText}}</small></i></button>\n                <button v-if=\"n.labelText==''\" class=\" btn btn-light2 left\"  :title=n.labelText></button>\n                <button  v-if='n.reminderDate!=null' class=\" btn btn-light2 darkcyan\" :title=n.displayDateTime ><i class=\"fas fa-bell\"></i> <small>{{n.displayDateTime}}</small>  </button>\n                <button  v-if='n.reminderDate==null' class=\" btn btn-light2 darkcyan\" ><i class=\"fas fa-bell invisible\" ></i></button>                                         \n                </template>\n  \n                <template v-if=\"n.isCompleted==true\">\n                <button class=\"btn btn-light2 left col system\">{{n.text}}  </button>                \n                <button v-if=\"n.labelText!=''\" class=\" btn btn-light2 left system\" :title=n.labelText> <i class=\"fas fa-tag\"> <small> {{n.labelText}}</small></i></button>\n                <button v-if=\"n.labelText==''\" class=\" btn btn-light2 left\"  :title=n.labelText></button>\n                <button  v-if='n.reminderDate!=null' class=\" btn btn-light2 system\" :title=n.displayDateTime ><i class=\"fas fa-bell\"></i> <small>{{n.displayDateTime}}</small>  </button>\n                <button  v-if='n.reminderDate==null' class=\" btn btn-light2 system\" ><i class=\"fas fa-bell invisible\" ></i></button>                                                       \n                <button class=\"btn btn-light2 left col-1 green\" @click='markIncomplete(n.id)'><i class=\"fas fa-check-double\"></i></button>                  \n                <button class=\"btn btn-light2 col-1  black\" @click='deleteNote(n.id,complete=true)' ><i class=\"fa fa-trash\"></i></button>\n                </template>\n            </div>\n    \n           \n          </div>\n  \n  \n          <div v-if=\"notes==''\"  class=\"row  top1\">          \n            <p class=\"left1  primary2\">No notes found</p>\n          </div> \n        </template>  \n         \n  \n  \n  \n        <span v-if=\"isNoteOptions\">\n        <div class=\"row  shadow  button  black top1\">\n          <button class=\"btn  left col black\" @click='toggleNoteOptions(noteIndex,noteId)'> {{notes[noteIndex].text}}</button>\n          <button class=\"btn  col col-md-2  green\" @click='markCompleted(noteId)' ><i class=\"fas fa-check\"></i> <small> completed</small></button>\n          <button class=\"btn  col-1  black\" @click='toggleEdit' ><i class=\"far fa-edit\"></i></button>            \n          <button class=\"btn  col-1  black\" @click='deleteNote(noteId)' ><i class=\"fa fa-trash\"></i></button>            \n          \n        </div>  \n        </span> \n  \n        <span v-if=\"isEdit\">\n          <div class=\"row  button  black top1\">\n            <input  class=\"col-10 black\" id=\"input_edit\" type=\"text\" :value='notes[noteIndex].text'>             \n  \n              <button v-if=\"!enabledLabel\" class=\"col-12 col-md btn \" @click=\"toggleLabel\" ><i class=\"fas fa-tag\"></i></button>            \n              <button v-if=\"!enabledNotification\" class=\"col-12 col-md btn \" @click=\"toggleNotification\" ><i class=\"fas fa-bell\"></i></button>\n          </div>  \n  \n          <div class=\"row top1\">    \n            \n            <button v-if=\"labelText!=''\" class=\"btn btn-light fas fa-tag\" :style=\"{color: labelColour}\" @click='deleteLabel()'><small> {{labelText}} -</small></button>\n            <button v-if='reminderDate!=null' class=\"btn darkcyan left left1\" @click='deleteReminder()' ><i class=\"fas fa-bell\" :title=displayDateTime><small> {{displayDateTime}} <i class=\"fas fa-trash-alt\"></i> </small> </i> </button>\n            \n          </div>  \n  \n          \n          \n          <div class=\"row\">\n            <button class=\"btn btn-primary2  top1 col-md-2\" @click='saveEdit' >ok</button>            \n            <button class=\"btn btn primary top1 col-md-2  m-md-1\" @click='toggleEdit'>cancel</button>            \n          </div>\n        </span> \n  \n        <transition>\n  \n          <div v-if='enabledLabel' class=\"modalContainer centre\">\n            <div  class=\"col-12 modal1 \">\n  \n              <h2 class=\"col-12 black\"><i class=\"fas fa-tag\"></i> </h2>  \n              \n              <div class=\"col-12 top1 black\"><small><b>Add label</b></small></div>\n              <input class=\"col-10 top1\" type=\"text\" id=\"input_label\"\n              :style=\"{ color: this.colour}\"\n              >   \n              <v-swatches class=\"top1\"\n              v-model=\"colour\"                              \n              shapes=\"circles\"\n                >\n              </v-swatches>\n              <button class=\"col-10 top1 btn btn-light\" @click='addLabel'>ok</button>\n              <button class=\"col-10 top1  btn black \" @click='toggleLabel'>cancel</button>\n              <!-- <button class=\"btn col\">cancel</button> -->             \n            </div>\n          </div>\n        </transition>\n  \n        \n  \n        \n         <transition>\n            <div v-if='enabledNotification' class=\"modalContainer\">\n              <div  class=\"col-12 centre modal1\">\n                <h2 class=\"col-12 black\"><i class=\"fas fa-bell\"></i> </h2> \n                <div class=\"col-12 black\"><small><b>Add Reminder</b></small></div>\n  \n                \n                  <div class=\"col\">\n                    <date-picker\n                      v-model=\"reminderDate\"\n                      type=\"date\"\n                      format='DD-MM-YYYY'\n                      placeholder=\"Reminder date\"\n                      :editable=false\n                      confirm=true\n                      confirm-text='ok'\n                      >\n                        \n                    </date-picker>\n  \n                    \n                  </div>\n  \n                  \n                  <div  class=\"col top2\">\n                    <date-picker \n                      v-model=\"reminderTime\"\n                      type=\"time\"\n                      format='HH:mm'\n                      placeholder=\"Reminder time \"\n                      :editable=false\n                      confirm=true\n                      confirm-text='ok'\n                      :clearable=true\n    \n                      :time-picker-options=\"{\n                        start: '00:00',\n                        step: '00:30',\n                        end: '23:30',\n                      }\"\n                      >\n                        \n                    </date-picker>\n                  </div>                          \n                <button class=\"col-10 top1 btn btn-light primary\" @click='addReminder'>add</button>\n                <button class=\"col-10 top1  btn black\" @click='toggleNotification'>cancel</button>\n                \n              </div>  \n            </div>  \n         </transition>\n        \n     </div>  \n  \n     \n  <div v-if=\"notes.length>4\" class=\"row  top1\">\n      <small class=\"col lightgrey\">scroll to see all notes</small>  \n  </div>\n        \n    <!-- <button class=\"btn btn-danger\" @click='deleteDB'>Delete all notes</button>   -->\n  \n    <!-- <button class=\"btn\" @click='loadData'>read</button>   -->\n  \n  \n  \n  \n    \n  \n  \n    </div>\n  </div>\n</template>\n\n<script>\nimport VSwatches from 'vue-swatches'\nimport 'vue-swatches/dist/vue-swatches.css'\n\nimport DatePicker from 'vue2-datepicker';\nimport 'vue2-datepicker/index.css';\n  \nimport draggable from 'vuedraggable'\n  \n\nexport default {\n  name: 'Main',\n  props: {\n    title: String,\n  },\n  components: { VSwatches,DatePicker,draggable },\n\n    mounted(){\n      this.loadData();\n      this.loadNotifications();\n    },\n\n  data(){\n    return{\n      option:1,\n      notes:[],  \n      notesNoLabel:[],    \n      enableAdd:false,\n      enabledLabel:false,\n      enabledNotification:false,\n      colour:'#000000',\n      labelText:'',\n      labelColour:'',            \n      labels:[],\n      selectedLabel:'All notes',\n      isNoteOptions:false,\n      noteIndex:'',\n      noteId:'',\n      selectedNote:[],\n      reminderDate: null,      \n      reminderTime: null, \n      displayDateTime:'',             \n      dateNull:false,\n      timeNull:false,\n      isEdit:false ,\n\n      isTagSearch:false,\n      isActiveReminder:false,\n      isUpcomingReminder:false,\n      activeReminders:0,\n      upcomingReminders:0,\n      notifications:0,\n      \n\n    }\n  },\n\n  methods:{\n    setOption(n){\n        this.option=n;       \n        this.isNoteOptions=false;\n        //show all notes\n        if(n==1){\n          this.loadData();\n          this.isActiveReminder=false;\n          this.isUpcomingReminder=false;\n        }\n        //show notes with reminders\n        if(n==2){\n          \n          this.loadActiveReminders();\n          \n          this.isActiveReminder=true;\n          this.isTagSearch=false;\n        }\n    },\n\n    addNew(){\n      \n      this.enableAdd=true;\n      this.isTagSearch=false;\n      this.isNoteOptions=false;\n      setTimeout(() => {\n        this.$refs.newNoteInput.focus();  \n      }, 200);      \n    },\n\n\n    closeAdd(){\n      this.enableAdd=false;\n      this.labels=[];\n      this.reminderDate= null;        \n      this.reminderTime= null; \n      this.timeNull=false;\n      this.dateNull=false;   \n      this.displayDateTime='';\n\n    },\n\n    toggleLabel(){      \n      this.enabledLabel=!this.enabledLabel;      \n      if(this.enabledLabel){\n        setTimeout(() => {\n        document.getElementById('input_label').focus();  \n        }, 100);\n      }\n      else{\n        setTimeout(() => {\n          if(this.enableAdd){\n            this.$refs.newNoteInput.focus();  \n          }\n          else{\n            document.getElementById('input_edit').focus();\n          }\n        \n        }, 100);\n      }\n    },\n\n    toggleNotification(){      \n      this.enabledNotification=!this.enabledNotification;\n\n      //cancel is clicked\n      if(!this.enabledNotification && this.displayDateTime==''){      \n                \n          this.reminderDate= null;        \n          this.reminderTime= null; \n          this.timeNull=false;\n          this.dateNull=false;   \n      }\n      \n\n    },\n\n    addLabel(){\n      this.labelText=document.getElementById('input_label').value.trim();\n      this.labelColour=this.colour;\n      // let newLabel={labelText:labelText,colour:labelColour};\n\n      // if(labelText.trim()!=''){\n      //     this.labels.push(newLabel);\n      //     this.toggleLabel();\n      //     }\n\n      if(this.labelText!=''){\n          // this.labels.splice(0,1,newLabel);\n          this.toggleLabel();\n          }\n\n      \n      \n    },\n\n    addReminder(){\n      // this.toggleNotification();      \n      if(this.reminderDate!=null && this.reminderTime!=null){\n        this.dateNull=false;\n        this.timeNull=false;\n        this.enabledNotification=!this.enabledNotification;\n\n        //reformat date\n        let fDate=this.reminderDate.toDateString();\n        fDate=fDate.split(' ');\n        fDate=fDate[2]+' '+fDate[1]+' '+fDate[3];\n        let displayDate=fDate;\n\n        //reformat time        \n        let fTime=this.reminderTime.toString();\n        fTime=fTime.split(' ');\n        fTime=fTime[4];\n        fTime=fTime.split(':');\n        fTime=fTime[0]+':'+fTime[1];\n        let displayTime=fTime;\n        this.displayDateTime=displayDate + ' '+displayTime        \n      }\n\n      if(this.reminderDate==null){\n        this.dateNull=true;\n      }\n\n      if(this.reminderTime==null){\n        this.timeNull=true;\n      }    \n    },\n\n    saveNew(){\n      let newNoteText=this.$refs.newNoteInput.value;\n      console.log(this.labels);\n\n      let newNote;\n      newNote={text:newNoteText,\n              reminderDate:this.reminderDate,\n              reminderTime:this.reminderTime,\n              displayDateTime:this.displayDateTime,\n              labelText:this.labelText,\n              labelColour:this.labelColour,\n              isCompleted:false\n              };\n    \n      let self = this;\n      \n      //indexedDB\n      const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;      \n      console.log(indexedDB);      \n      const request= indexedDB.open('todoDatabase',1);\n      \n      //onerror\n      request.onerror=function(event){\n        console.log(event);\n      }\n\n      //onupgradeneeded\n      request.onupgradeneeded=function(event){\n        let db = event.target.result;\n        let objectStore=db.createObjectStore('notes', { keyPath: \"id\", autoIncrement: true });        \n        objectStore.createIndex('labelIndex','note.labelText',{unique:false});  \n        objectStore.createIndex('noteIndex',['note.text'],{unique:false}); \n        objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n        objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});           \n        console.log(\"Object store Created Successfully...\");\n      }\n\n      //onsuccess\n      request.onsuccess = function (event){       \n       var db = event.target.result;\n       console.log(db);\n       var transaction = db.transaction(\"notes\", \"readwrite\");\n       var objectStore = transaction.objectStore(\"notes\");     \n       \n       if(newNoteText.trim()!=''){\n       objectStore.add({ note: newNote});\n        db.close();\n        self.enableAdd=false;\n        self.labelText='',\n        self.labelColour=''\n        \n        self.reminderDate=null;\n        self.reminderTime=null;\n        self.displayDateTime='';\n\n      }\n       transaction.oncomplete = function () {   \n       self.labels=[];\n       self.selectedLabel='All notes';             \n       self.loadData();\n       self.loadNotifications();\n        };\n     }\n\n    },\n\n    toggleNoteOptions(n,id){      \n      \n      this.selectedNote=[];\n      //get selected note's id\n      this.noteId=id;\n\n\n      //set get selected note\n      for(let n of this.notes){\n\n        console.log(n.id);\n        if(n.id==id){\n          this.selectedNote.push(n);\n        }\n      }\n\n      console.log(this.notes);\n      console.log(this.selectedNote);\n      this.noteIndex=n;      \n      this.isNoteOptions=!this.isNoteOptions;\n    },\n\n    deleteNote(id,complete){      \n    //  this.notes.splice(n,1);\n    //  this.isNoteOptions=!this.isNoteOptions;\n\n\n    //delete note from db\n\n    let self=this;\n        const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n        const request = indexedDB.open(\"todoDatabase\", 1);\n      \n        request.onerror = function(){\n            console.log(\"request error deleteNote\");\n        }\n\n        request.onupgradeneeded = function(event) {\n            var db = event.target.result;\n            var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n            objectStore.createIndex('labelIndex','note.labelText',{unique:false});  \n            objectStore.createIndex('noteIndex',['note.text'],{unique:false});\n            objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n            objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});                \n            console.log(\"Object store Created Successfully...\");\n        };\n\n\n        request.onsuccess = function (event){       \n          var db = event.target.result;\n          let transaction = db.transaction('notes','readwrite');\n          const objectStore = transaction.objectStore(\"notes\");\n\n          const deleteNote = objectStore.delete(id);\n          deleteNote.onsuccess = function(){\n          console.log('note id: '+id+ ' deleted');\n          \n         }  \n            \n          transaction.oncomplete = function () {     \n\n            if(self.option==1){\n              if(self.isTagSearch){                  \n                self.selectedLabel='All notes';          \n                self.loadTags();  \n              }\n              else{\n                self.loadData();  \n\n                self.labels=[];\n                  self.reminder=[];\n                  self.reminderDate=null;\n                  self.reminderTime=null;\n                  self.displayDateTime='';\n\n              }   \n            }\n            else if(self.option==2){\n\n              if(self.isActiveReminder){\n                self.loadActiveReminders();\n               }\n               else{\n                self.loadUpcomingReminders();\n               }\n\n            }\n\n            \n            \n            if(complete==true){\n              this.isNoteOptions=false;\n              \n            }\n            else{\n              self.isNoteOptions=!self.isNoteOptions;              \n            }\n            db.close();\n            self.loadNotifications();\n          };\n          \n        }\n\n    },\n\n    toggleEdit(){               \n      this.isEdit=!this.isEdit;\n      this.isNoteOptions=!this.isNoteOptions;\n       \n      setTimeout(() => {\n        if(this.isEdit){\n\n        document.getElementById('input_edit').focus();\n        \n        this.labelText= this.notes[this.noteIndex].labelText;\n        \n        this.labelColour= this.notes[this.noteIndex].labelColour;\n      \n        \n        this.reminderDate=null;\n        this.reminderTime=null;\n\n        this.reminderDate=this.notes[this.noteIndex].reminderDate;\n        this.reminderTime=this.notes[this.noteIndex].reminderTime;\n        this.displayDateTime=this.notes[this.noteIndex].displayDateTime;\n        \n      }\n      }, 100);\n      \n\n    },\n\n    saveEdit(){\n      if(document.getElementById('input_edit').value.trim()!=''){\n\n        //updated field values\n          let text= document.getElementById('input_edit').value.trim();\n          let labelText=this.labelText;\n          let labelColour=this.labelColour;\n          let reminderDate=this.reminderDate;\n          let reminderTime=this.reminderTime;\n          let displayDateTime = this.displayDateTime;\n          \n\n        //save changes to indexedDB\n        let self=this;\n        const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n        const request = indexedDB.open(\"todoDatabase\", 1);\n                        \n        request.onerror = function(){\n            console.log(\"request error - saveEdit\");\n        }\n\n        request.onupgradeneeded = function(event) {\n            var db = event.target.result;\n            var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n            objectStore.createIndex('labelIndex',['note.labelText'],{unique:false});  \n            objectStore.createIndex('noteIndex',['note.text'],{unique:false}); \n            objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n            objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});   \n            \n            console.log(\"Object store Created Successfully...\");\n        };\n\n        \n\n        request.onsuccess = function (event){       \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\",\"readwrite\");\n          const objectStore = transaction.objectStore(\"notes\");\n\n          //get record to modify\n          const recordRequest = objectStore.get(self.noteId);\n\n          \n\n          recordRequest.onsuccess=function(){\n\n            \n            let record = recordRequest.result;\n            console.log(record);    \n                    \n            record.note.text = text;\n            record.note.reminderDate=reminderDate;\n            record.note.reminderTime=reminderTime;\n            record.note.displayDateTime=displayDateTime;            \n            record.note.labelText=labelText;\n            record.note.labelColour=labelColour;\n            record.note.isCompleted=false;\n\n\n            //save new values to indexedDB\n            const updateRequest=objectStore.put(record);\n\n            updateRequest.onsuccess=function(){\n              console.log('record updated');\n            }\n            \n          }\n          transaction.oncomplete = function () {\n            self.labelText='';\n            self.labelColour='';            \n            self.reminderDate=null;\n            self.reminderTime=null;\n            self.displayDateTime='';\n\n            //show all notes (filtered by tag or not)\n            if(self.option==1){\n              if(self.isTagSearch){    \n                if(self.selectedLabel!='All notes'){\n                  self.selectedLabel=labelText;         \n                }  \n                            \n                 self.loadTags();  \n              }\n              else{\n                self.loadData();  \n              }\n            }\n            //show notes with reminders\n            else if (self.option==2){\n               if(self.isActiveReminder){\n                self.loadActiveReminders();\n               }\n               else{\n                self.loadUpcomingReminders();\n               }\n               \n            }\n            self.loadNotifications();                                                      \n            db.close();\n          };\n\n\n          };\n\n      }\n      \n      \n      this.isEdit=!this.isEdit;\n      \n     \n    },\n\n    deleteLabel(){            \n      this.labelText='';\n      this.labelColour='';\n    },\n\n    deleteReminder(){    \n            \n      this.reminderDate=null;\n      this.reminderTime=null;\n      this.displayDateTime='';\n      if(this.notes!=''){\n        this.notes[this.noteIndex].reminder.reminderDate=null;\n        this.notes[this.noteIndex].reminder.reminderTime=null;\n      }\n      \n    },\n\n     toggleTimePanel() {\n      this.showTimePanel = !this.showTimePanel;\n    },\n\n    loadData(){\n      \n        \n        let self=this;\n        const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n        const request = indexedDB.open(\"todoDatabase\", 1);\n        \n        let foundNotes=[];\n        \n        request.onerror = function(){\n            console.log(\"database test creation error\");\n        }\n\n        request.onupgradeneeded = function(event) {\n            var db = event.target.result;\n            var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n            objectStore.createIndex('labelIndex','note.labelText',{unique:false});  \n            objectStore.createIndex('noteIndex',['note.text'],{unique:false});  \n            objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n          objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});  \n            \n            console.log(\"Object store Created Successfully...\");\n        };\n\n\n        request.onsuccess = function (event){       \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\");\n          const objectStore = transaction.objectStore(\"notes\");\n\n            // read through table\n            objectStore.openCursor().onsuccess = event => { \n              var cursor = event.target.result; \n              if (cursor) { \n                console.log('is cursor')\n                  \n                  let record;\n                  \n                     record={id:cursor.value.id,\n                             text:cursor.value.note.text,\n                             labelText:cursor.value.note.labelText,\n                             labelColour:cursor.value.note.labelColour,\n                             reminderDate:cursor.value.note.reminderDate,\n                             reminderTime:cursor.value.note.reminderTime,\n                             displayDateTime:cursor.value.note.displayDateTime,\n                             isCompleted:cursor.value.note.isCompleted\n                             }\n                             \n                  \n                  \n                  console.log(record);\n                  foundNotes.push(record);              \n                  console.log(cursor.value);\n\n                  console.log(\"id: \"+ cursor.value.id);\n                  console.log(\"text: \"+ cursor.value.note.text);\n                  \n                  cursor.continue(); \n              } else { \n                  console.log('end of table');\n              } \n            };\n\n          \n            \n          transaction.oncomplete = function () {\n            console.log(foundNotes);\n            self.notes=[];\n            for(let n of foundNotes){\n              self.notes.push(n);          \n            }\n                                    \n             console.log(self.notes)\n             \n            db.close();\n          };\n\n          \n        }\n\n    \n\n    },\n\n    deleteDB(){\n\n      const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n      \n      indexedDB.deleteDatabase(\"todoDatabase\");      \n      \n    },\n\n    resort(){\n\n      let self =this;\n      \n      this.deleteDB(); \n  \n      const request = indexedDB.open(\"todoDatabase\",1);\n\n      request.onupgradeneeded=function(event){\n        let db = event.target.result;\n        let objectStore=db.createObjectStore('notes', { keyPath: \"id\", autoIncrement: true });        \n        objectStore.createIndex('labelIndex',['note.labelText'],{unique:false});  \n        objectStore.createIndex('noteIndex',['note.text'],{unique:false});  \n        objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n        objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});  \n        \n        console.log(\"Object store Created Successfully...\");\n      }\n\n       request.onsuccess = function (event){       \n       var db = event.target.result;\n       let transaction = db.transaction(\"notes\",\"readwrite\");\n       const objectStore = transaction.objectStore(\"notes\");\n        console.log(objectStore);\n\n      \n\n      self.notes.forEach(function (n) {     \n      let newNote={ \n                   text:n.text,\n                   labelText:n.labelText,\n                   labelColour:n.labelColour,\n                   reminderDate:n.reminderDate,\n                   reminderTime:n.reminderTime,\n                   displayDateTime:n.displayDateTime,\n                   isCompleted:n.isCompleted\n                   \n                   }\n      objectStore.add({ note: newNote});\n      \n      console.log(n.text+'-'+ n.id)          \n          // objectStore.put({id: n, name: \"deevana\",branch: \"CSE\"});\n      })\n \n      transaction.oncomplete = function () {        \n        console.log('resorting updated');\n        \n        self.loadData();\n        db.close();\n\n      };\n\n    \n          \n    }\n\n    },\n\n    toggleTagSearch(){\n      this.isTagSearch=!this.isTagSearch;\n      this.enableAdd=false;\n      this.isNoteOptions=false;\n      if(this.isTagSearch){\n        this.loadTags();\n        \n      }\n      else{\n        this.unloadTags();\n      }\n      \n    }, \n\n    loadLabels(){\n      //populate labels[] with labelText values\n\n      this.labels=[];\n      this.labels.push('All notes');\n\n\n\n      let self=this;\n      const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n      const request = indexedDB.open(\"todoDatabase\", 1);\n              \n      request.onerror = function(){\n            console.log(\"database test creation error\");\n      }\n\n      request.onupgradeneeded = function(event) {\n            var db = event.target.result;\n            var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n            objectStore.createIndex('labelIndex','note.labelText',{unique:false});  \n            objectStore.createIndex('noteIndex',['note.text'],{unique:false});  \n            objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n            objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});  \n            console.log(\"Object store Created Successfully...\");\n        };\n\n\n        request.onsuccess = function (event){   \n          \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\");          \n          const objectStore = transaction.objectStore(\"notes\");\n          let labelIndex = objectStore.index(\"labelIndex\");\n          \n\n          \n\n          let request  = labelIndex.getAll();\n          \n          \n                    \n          request.onsuccess = function(){\n            console.log('success');\n            console.log(request.result);\n            let results= request.result;\n            \n            for(let r of results){\n                            \n               let exists=false;\n                self.labels.forEach(l => {\n                 if(r.note.labelText==l){\n                  exists=true;\n                 } \n                });\n\n                if(exists==false){\n                  \n                  self.labels.push(r.note.labelText);\n                }   \n\n            }            \n            \n         };\n\n          transaction.oncomplete = function () {                                  \n            db.close();\n          };\n        }           \n    },\n\n    \n    loadTags(){\n        \n        this.enableAdd=false;\n        this.notes=[];\n        this.loadLabels();\n\n      \n        \n        let self=this;\n        const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n        const request = indexedDB.open(\"todoDatabase\", 1);\n        \n        \n        \n        request.onerror = function(){\n            console.log(\"database test creation error\");\n        }\n\n        request.onupgradeneeded = function(event) {\n            var db = event.target.result;\n            var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n            objectStore.createIndex('labelIndex','note.labelText',{unique:false});  \n            objectStore.createIndex('noteIndex',['note.text'],{unique:false});  \n            objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n            objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});  \n            console.log(\"Object store Created Successfully...\");\n        };\n\n\n        request.onsuccess = function (event){   \n          \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\");          \n          const objectStore = transaction.objectStore(\"notes\");\n          let labelIndex = objectStore.index(\"labelIndex\");\n          \n\n          let request='';\n          if(self.selectedLabel=='All notes'){\n            request = labelIndex.getAll();\n\n          }\n          else{\n            request = labelIndex.getAll(self.selectedLabel);\n           \n          }\n                    \n          request.onsuccess = function(){\n            console.log('success');\n            console.log(request.result);\n            let results= request.result;\n            console.log(results);\n            for(let r of results){\n              let resultNote={id:r.id,\n                              text:r.note.text,\n                              labelText:r.note.labelText,\n                              labelColour:r.note.labelColour,\n                              reminderDate:r.note.reminderDate,\n                              reminderTime:r.note.reminderTime,\n                              displayDateTime:r.note.displayDateTime,\n                              isCompleted:r.note.isCompleted\n                              }\n\n              \n              \n\n                                         \n                //push note into notes[]\n                self.notes.push(resultNote);\n                console.log(self.notes);\n            }            \n            \n         };\n\n          transaction.oncomplete = function () {                                  \n            db.close();\n          };\n        }\n      console.log('TAGS');\n    },\n\n    unloadTags(){\n      this.loadData();\n      this.labels=[];\n      this.selectedLabel='All notes';\n    },\n\n    //counts how many reminders expired\n    loadNotifications(){\n      this.notifications=0;\n      \n      \n      let self=this;\n      const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n      const request = indexedDB.open(\"todoDatabase\", 1);\n        \n      request.onerror = function(){\n          console.log(\"database test creation error\");\n      }\n\n      request.onupgradeneeded = function(event) {\n          var db = event.target.result;\n          var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n          objectStore.createIndex('labelIndex','note.labelText',{unique:false});  \n          objectStore.createIndex('noteIndex',['note.text'],{unique:false});  \n          objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n          objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});  \n\n          console.log(\"Object store Created Successfully...\");\n      };\n\n\n        request.onsuccess = function (event){   \n          \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\");          \n          const objectStore = transaction.objectStore(\"notes\");\n          let dateIndex = objectStore.index(\"dateIndex\");\n          let request='';\n          request = dateIndex.getAll();\n                      \n          request.onsuccess = function(){\n            console.log('success');\n            console.log(request.result);\n            let results= request.result;\n            console.log(results);\n            \n            \n            let now = new Date();\n            now = now.getTime();\n            \n            \n            \n            for(let r of results){\n\n             //reconstruct date and time to compare it with current date and time   \n             let dateToString=r.note.reminderDate.toString();\n             let actualDate1=dateToString.split(' ');                \n             actualDate1=actualDate1[0]+' '+actualDate1[1]+' '+actualDate1[2]+' '+actualDate1[3];\n\n             let timeToString=r.note.reminderTime.toString();\n             let actualTime1=timeToString.split(' ');                \n             actualTime1=actualTime1[4]+' '+actualTime1[5]+' '+actualTime1[6];\n             \n             let actualDateTime=actualDate1+' '+actualTime1;\n             console.log(actualDateTime);\n\n             //reconvert to Date format\n             actualDateTime=new Date(actualDateTime);\n                                                        \n             //compare with current Date and Time\n             //if reminder has not expired, push note into notes[]\n             if(actualDateTime.getTime()<now){\n              self.notifications++;\n             }\n             \n                                            \n            }            \n            \n         };\n\n          transaction.oncomplete = function () {                                  \n            db.close();\n          };\n        }\n      \n    },\n\n    loadActiveReminders(){\n      this.activeReminders=0;  \n      this.upcomingReminders=0;\n      this.notes=[];\n      let self=this;\n      const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n      const request = indexedDB.open(\"todoDatabase\", 1);\n        \n      request.onerror = function(){\n          console.log(\"database test creation error\");\n      }\n\n      request.onupgradeneeded = function(event) {\n          var db = event.target.result;\n          var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n          objectStore.createIndex('labelIndex','note.labelText',{unique:false});  \n          objectStore.createIndex('noteIndex',['note.text'],{unique:false});  \n          objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n          objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});  \n\n          console.log(\"Object store Created Successfully...\");\n      };\n\n\n        request.onsuccess = function (event){   \n          \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\");          \n          const objectStore = transaction.objectStore(\"notes\");\n          let dateIndex = objectStore.index(\"dateIndex\");\n          let request='';\n          request = dateIndex.getAll();\n                      \n          request.onsuccess = function(){\n            console.log('success');\n            console.log(request.result);\n            let results= request.result;\n            console.log(results);\n            \n            \n            let now = new Date();\n            now = now.getTime();\n            \n            \n            \n            for(let r of results){\n\n             //reconstruct date and time to compare it with current date and time   \n             let dateToString=r.note.reminderDate.toString();\n             let actualDate1=dateToString.split(' ');                \n             actualDate1=actualDate1[0]+' '+actualDate1[1]+' '+actualDate1[2]+' '+actualDate1[3];\n\n             let timeToString=r.note.reminderTime.toString();\n             let actualTime1=timeToString.split(' ');                \n             actualTime1=actualTime1[4]+' '+actualTime1[5]+' '+actualTime1[6];\n             \n             let actualDateTime=actualDate1+' '+actualTime1;\n             console.log(actualDateTime);\n\n             //reconvert to Date format\n             actualDateTime=new Date(actualDateTime);\n\n             \n\n              let resultNote={id:r.id,\n                              text:r.note.text,\n                              labelText:r.note.labelText,\n                              labelColour:r.note.labelColour,\n                              reminderDate:r.note.reminderDate,\n                              reminderTime:r.note.reminderTime,\n                              displayDateTime:r.note.displayDateTime,\n                              isCompleted:r.note.isCompleted\n                              }\n                            \n                \n             //compare with current Date and Time\n             //if reminder has not expired, push note into notes[]\n             if(actualDateTime.getTime()<now){\n              self.notes.push(resultNote);\n              self.activeReminders++;\n              console.log(self.notes);\n             }\n             else{\n              self.upcomingReminders++;\n             }\n                                            \n            }            \n            \n         };\n\n          transaction.oncomplete = function () {                                  \n            db.close();\n          };\n        }\n      \n    },\n\n\n\n    loadUpcomingReminders(){\n\n      this.notes=[];\n      this.upcomingReminders=0;\n      this.activeReminders=0;  \n      \n      let self=this;\n      const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n      const request = indexedDB.open(\"todoDatabase\", 1);\n        \n      request.onerror = function(){\n          console.log(\"database test creation error\");\n      }\n\n      request.onupgradeneeded = function(event) {\n          var db = event.target.result;\n          var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n          objectStore.createIndex('labelIndex','note.labelText',{unique:false});  \n          objectStore.createIndex('noteIndex',['note.text'],{unique:false});  \n          objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n          objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});  \n\n          console.log(\"Object store Created Successfully...\");\n      };\n\n\n        request.onsuccess = function (event){   \n          \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\");          \n          const objectStore = transaction.objectStore(\"notes\");\n          let dateIndex = objectStore.index(\"dateIndex\");\n          let request='';\n          request = dateIndex.getAll();\n                      \n          request.onsuccess = function(){\n            console.log('success');\n            console.log(request.result);\n            let results= request.result;\n            console.log(results);\n            \n            \n            let now = new Date();\n            now = now.getTime();\n            \n            \n            \n            for(let r of results){\n\n             //reconstruct date and time to compare it with current date and time   \n             let dateToString=r.note.reminderDate.toString();\n             let actualDate1=dateToString.split(' ');                \n             actualDate1=actualDate1[0]+' '+actualDate1[1]+' '+actualDate1[2]+' '+actualDate1[3];\n\n             let timeToString=r.note.reminderTime.toString();\n             let actualTime1=timeToString.split(' ');                \n             actualTime1=actualTime1[4]+' '+actualTime1[5]+' '+actualTime1[6];\n             \n             let actualDateTime=actualDate1+' '+actualTime1;\n             console.log(actualDateTime);\n\n             //reconvert to Date format\n             actualDateTime=new Date(actualDateTime);\n\n             \n\n              let resultNote={id:r.id,\n                              text:r.note.text,\n                              labelText:r.note.labelText,\n                              labelColour:r.note.labelColour,\n                              reminderDate:r.note.reminderDate,\n                              reminderTime:r.note.reminderTime,\n                              displayDateTime:r.note.displayDateTime,\n                              isCompleted:r.note.isCompleted\n                              }\n                            \n                \n             //compare with current Date and Time\n             //if reminder has expired, push note into notes[]\n             if(actualDateTime.getTime()>now){\n              self.notes.push(resultNote);\n              self.upcomingReminders++;\n              console.log(self.notes);\n             }\n             else{\n              self.activeReminders++;\n             }\n                                            \n            }            \n            \n         };\n\n          transaction.oncomplete = function () {                                  \n            db.close();\n          };\n        }\n      //\n    },\n\n    toggleReminders(n){\n      \n      if(n==1){\n        this.isActiveReminder=true;\n        this.isUpcomingReminder=false;\n        this.loadActiveReminders();\n      }\n      else{\n        this.isActiveReminder=false;\n        this.isUpcomingReminder=true;\n        this.loadUpcomingReminders();\n      }\n\n      \n\n    },\n\n    //marks note as completed\n    markCompleted(noteId){\n      //\n      \n\n        let self=this;\n        const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n        const request = indexedDB.open(\"todoDatabase\", 1);\n                        \n        request.onerror = function(){\n            console.log(\"request error - markCompleted\");\n        }\n\n        request.onupgradeneeded = function(event) {\n            var db = event.target.result;\n            var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n            objectStore.createIndex('labelIndex',['note.labelText'],{unique:false});  \n            objectStore.createIndex('noteIndex',['note.text'],{unique:false}); \n            objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n            objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});   \n            \n            console.log(\"Object store Created Successfully...\");\n        };\n      \n        request.onsuccess = function (event){       \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\",\"readwrite\");\n          const objectStore = transaction.objectStore(\"notes\");\n\n          //get record to modify\n          const recordRequest = objectStore.get(noteId);\n\n          recordRequest.onsuccess=function(){\n\n            let record = recordRequest.result;\n            console.log(record);    \n                    \n            // record.note.text = text;\n            // record.note.reminderDate=reminderDate;\n            // record.note.reminderTime=reminderTime;\n            // record.note.displayDateTime=displayDateTime;            \n            // record.note.labelText=labelText;\n            // record.note.labelColour=labelColour;\n            record.note.isCompleted=true;\n\n\n            //save new values to indexedDB\n            const updateRequest=objectStore.put(record);\n\n            updateRequest.onsuccess=function(){\n              console.log('record updated');\n            }\n            \n          }\n          transaction.oncomplete = function () {\n          \n            //show all notes (filtered by tag or not)\n            if(self.option==1){\n              if(self.isTagSearch){    \n                if(self.selectedLabel!='All notes'){\n                  self.selectedLabel=self.selectedNote[0].labelText;                           \n                }  \n                            \n                 self.loadTags();  \n              }\n              else{\n                self.loadData();  \n              }\n            }\n            //show notes with reminders\n            else if (self.option==2){\n               if(self.isActiveReminder){\n                self.loadActiveReminders();\n               }\n               else{\n                self.loadUpcomingReminders();\n               }\n               \n            }\n          \n                                                                  \n            db.close();\n            self.isNoteOptions=false;\n          };\n\n\n          };\n\n\n\n\n    },\n\n    markIncomplete(noteId){\n      //\n       let self=this;\n        const indexedDB = window.indexedDB || window.mozIndexedDB ||window.webkitIndexedDB ||window.msIndexedDB ||window.shimIndexedDB;\n        \n        const request = indexedDB.open(\"todoDatabase\", 1);\n                        \n        request.onerror = function(){\n            console.log(\"request error - markCompleted\");\n        }\n\n        request.onupgradeneeded = function(event) {\n            var db = event.target.result;\n            var objectStore = db.createObjectStore(\"notes\",{keyPath :\"id\",  autoIncrement:true});\n            objectStore.createIndex('labelIndex',['note.labelText'],{unique:false});  \n            objectStore.createIndex('noteIndex',['note.text'],{unique:false}); \n            objectStore.createIndex('dateIndex',['note.reminderDate'],{unique:false});  \n            objectStore.createIndex('timeIndex',['note.reminderTime'],{unique:false});   \n            \n            console.log(\"Object store Created Successfully...\");\n        };\n      \n        request.onsuccess = function (event){       \n          var db = event.target.result;\n          let transaction = db.transaction(\"notes\",\"readwrite\");\n          const objectStore = transaction.objectStore(\"notes\");\n\n          //get record to modify\n          const recordRequest = objectStore.get(noteId);\n\n          recordRequest.onsuccess=function(){\n\n            let record = recordRequest.result;\n            console.log(record);    \n                    \n            record.note.isCompleted=false;\n\n\n            //save new values to indexedDB\n            const updateRequest=objectStore.put(record);\n\n            updateRequest.onsuccess=function(){\n              console.log('record updated');\n            }\n            \n          }\n          transaction.oncomplete = function () {\n            \n\n            //show all notes (filtered by tag or not)\n            if(self.option==1){\n              if(self.isTagSearch){    \n                console.log(self.selectedLabel);      \n                if(self.selectedLabel!='All notes'){\n                  // self.selectedLabel=self.labelText; \n                  // console.log(self.selectedLabel);                     \n                }  \n                            \n                 self.loadTags();  \n              }\n              else{\n                self.loadData();  \n              }\n            }\n            //show notes with reminders\n            else if (self.option==2){\n               if(self.isActiveReminder){\n                self.loadActiveReminders();\n               }\n               else{\n                self.loadUpcomingReminders();\n               }\n               \n            }\n                                                                  \n            db.close();\n            self.isNoteOptions=false;\n          };\n\n\n          };\n    }\n\n  }\n\n}\n</script>\n\n\n"]}]}